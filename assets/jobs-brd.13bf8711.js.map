{"version":3,"file":"assets/jobs-brd.13bf8711.js","mappings":"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","sources":["webpack://@xivanalysis/client/./src/parser/core/modules/ActionTimeline/ActionTimeline.tsx","webpack://@xivanalysis/client/./src/parser/core/modules/ActionTimeline/ActionTimeline.module.css?2f05","webpack://@xivanalysis/client/./src/parser/core/modules/AlwaysBeCasting.tsx","webpack://@xivanalysis/client/./src/parser/core/modules/DoTs.ts","webpack://@xivanalysis/client/./src/parser/core/modules/GlobalCooldown.tsx","webpack://@xivanalysis/client/./src/parser/core/modules/Statuses.ts","webpack://@xivanalysis/client/./src/parser/jobs/brd/modules/ActionTimeline.tsx","webpack://@xivanalysis/client/./src/parser/jobs/brd/modules/AlwaysBeCasting.ts","webpack://@xivanalysis/client/./src/parser/jobs/brd/modules/DoTs.tsx","webpack://@xivanalysis/client/./src/parser/jobs/brd/modules/DriftingEa.tsx","webpack://@xivanalysis/client/./src/parser/jobs/brd/modules/Mitigation.tsx","webpack://@xivanalysis/client/./src/parser/jobs/brd/modules/MultiHitSkills.ts","webpack://@xivanalysis/client/./src/parser/jobs/brd/modules/DISPLAY_ORDER.ts","webpack://@xivanalysis/client/./src/parser/jobs/brd/modules/OGCDDowntime.ts","webpack://@xivanalysis/client/./src/parser/jobs/brd/modules/RagingStrikes.tsx","webpack://@xivanalysis/client/./src/parser/jobs/brd/modules/RefulgentProcs.tsx","webpack://@xivanalysis/client/./src/parser/jobs/brd/modules/index.ts"],"sourcesContent":["import {Trans} from '@lingui/react'\nimport {Action, ActionKey} from 'data/ACTIONS'\nimport {Analyser} from 'parser/core/Analyser'\nimport {dependency} from 'parser/core/Injectable'\nimport CastTime from 'parser/core/modules/CastTime'\nimport {ChargeHistoryEntry, CooldownEndReason, CooldownGroup, CooldownHistoryEntry, Cooldowns, SelectionSpecifier} from 'parser/core/modules/Cooldowns'\nimport {Data} from 'parser/core/modules/Data'\nimport {ActionItem, BaseItem, ContainerRow, SimpleItem, Timeline} from 'parser/core/modules/Timeline'\nimport React, {ReactNode} from 'react'\nimport {Icon} from 'semantic-ui-react'\nimport {ensureArray, isDefined} from 'utilities'\nimport styles from './ActionTimeline.module.css'\n\nconst ANIMATION_LOCK = 100\n\n// We're excluding the Action interface as it's unessecary for this config format, and complicates the discrimination later.\ntype RowSpecifierEntry = Exclude<SelectionSpecifier, Action>\n\n/**\n * One or more actions, action keys, or cooldown group IDs. The special-case\n * value \"GCD\" is available for selection of the GCD cooldown group.\n */\nexport type RowSpecifier = RowSpecifierEntry | RowSpecifierEntry[]\n\n/** Advanced configuration options for a row. */\nexport interface ActionRowConfig {\n\t/** Specifier(s) for items that should be displayed in this row. */\n\tcontent: RowSpecifier\n\t/** Label to display for the row. */\n\tlabel?: ReactNode\n\t/** Order of the row within the timeline. */\n\torder?: number\n}\n\n/** Configuration for a single row. */\nexport type ActionRow = RowSpecifier | ActionRowConfig\n\n// Internal row config used within the module\ntype InternalRowConfig =\n\t& Omit<ActionRowConfig, 'content'>\n\t& {content: readonly SelectionSpecifier[]}\n\nenum ItemDepth {\n\tCHARGE_GAIN = 0,\n\tACTION = 1,\n}\n\nexport class ActionTimeline extends Analyser {\n\tstatic override handle = 'actionTimeline'\n\tstatic override debug = false\n\n\t/**\n\t * Configuration for the rows generated by this module. Any cooldown groups\n\t * not represented in this configuration will be added to automatically\n\t * generated rows in order of use.\n\t */\n\tstatic rows: ActionRow[] = [\n\t\t{content: 'GCD', order: -97},\n\t]\n\n\t@dependency private castTime!: CastTime\n\t@dependency private cooldowns!: Cooldowns\n\t@dependency private data!: Data\n\t@dependency private timeline!: Timeline\n\n\tprivate resolvedRows: InternalRowConfig[] = []\n\tprivate groupRows = new Map<CooldownGroup, ContainerRow>()\n\n\t/** Retrieve the timeline row representing the specified action. */\n\tgetRow(action: ActionKey | Action) {\n\t\treturn this.addRow({content: [action]})\n\t}\n\n\toverride initialise() {\n\t\t// Add rows for all the configured entries\n\t\tfor (const config of (this.constructor as typeof ActionTimeline).rows) {\n\t\t\tconst resolvedConfig = this.resolveConfig(config)\n\t\t\tthis.resolvedRows.push(resolvedConfig)\n\t\t\tthis.addRow(resolvedConfig)\n\t\t}\n\n\t\tthis.addEventHook('complete', this.onComplete)\n\t}\n\n\tprivate onComplete() {\n\t\t// Track the groups with configured rows so backfill doesn't duplicate\n\t\tconst populatedGroups = new Set<number>()\n\n\t\t// Add rows for all the configured entries\n\t\tfor (const config of this.resolvedRows) {\n\t\t\tconst row = this.addRow(config)\n\t\t\tthis.populateRow(row, config)\n\t\t\tconfig.content.forEach(specifier =>\n\t\t\t\tthis.cooldowns.groups(specifier).forEach(group => populatedGroups.add(group))\n\t\t\t)\n\t\t}\n\n\t\t// Figure out what groups have not been explicitly configured and build rows for them\n\t\tthis.cooldowns.allGroups()\n\t\t\t.filter(group => !populatedGroups.has(group))\n\t\t\t.forEach(group => {\n\t\t\t\tconst config = {content: [group]}\n\t\t\t\tconst row = this.addRow(config)\n\t\t\t\tthis.populateRow(row, config)\n\t\t\t})\n\t}\n\n\tprivate resolveConfig(config: ActionRow): InternalRowConfig {\n\t\t// Standardise the simple config into the main config shape\n\t\tlet finalConfig = config\n\t\tif (typeof finalConfig !== 'object' || Array.isArray(finalConfig)) {\n\t\t\tfinalConfig = {content: finalConfig}\n\t\t}\n\t\treturn {\n\t\t\t...finalConfig,\n\t\t\tcontent: ensureArray(finalConfig.content),\n\t\t}\n\t}\n\n\tprivate addRow(config: InternalRowConfig) {\n\t\t// If there's already a row for one of the specifiers, use it\n\t\tconst groups = config.content.flatMap(specifier => this.cooldowns.groups(specifier))\n\t\tconst existingRow = groups\n\t\t\t.map(group => this.groupRows.get(group))\n\t\t\t.find(isDefined)\n\t\tif (existingRow != null) {\n\t\t\treturn existingRow\n\t\t}\n\n\t\t// Using an IIFE because pattern matching isn't in the spec yet\n\t\tconst firstContent = config.content[0]\n\t\tconst label = (() => {\n\t\t\tif (config.label != null) { return config.label }\n\t\t\tif (firstContent === 'GCD')  { return <Trans id=\"core.action-timeline.label.gcd\">GCD</Trans> }\n\t\t\tif (typeof firstContent === 'string') { return this.data.actions[firstContent].name }\n\t\t\tif (typeof firstContent === 'number') { return this.cooldowns.cooldownHistory(firstContent)[0]?.action.name }\n\t\t\treturn firstContent.name\n\t\t})()\n\n\t\t// Build the row and save it to the groups for this config\n\t\t// TODO: collision handling?\n\t\tconst row = this.timeline.addRow(new ContainerRow({\n\t\t\tlabel,\n\t\t\torder: config.order,\n\t\t\tcollapse: true,\n\t\t}))\n\t\tgroups.forEach(group => this.groupRows.set(group, row))\n\n\t\treturn row\n\t}\n\n\tprivate populateRow(row: ContainerRow, {content}: InternalRowConfig) {\n\t\t// Add all the items\n\t\tthis.addCooldownItems(row, content.flatMap(specifier => this.cooldowns.cooldownHistory(specifier)))\n\t\tthis.addChargeItems(row, content.flatMap(specifier => this.cooldowns.chargeHistory(specifier)))\n\t}\n\n\tprivate addCooldownItems(row: ContainerRow, history: CooldownHistoryEntry[]) {\n\t\tfor (const entry of history) {\n\t\t\tconst duration = this.getCooldownDuration(entry)\n\n\t\t\t// TODO: with the adjusted cast time we might get some overlaps, should we try to avoid that?]\n\t\t\t// TODO: Add interrupt visuals. CD2 only records interrupts within the bounds of a cooldown, so we'll need to track it in some manner for long-cast actions.\n\t\t\tconst start = entry.start - this.parser.pull.timestamp\n\t\t\tconst end = start + duration\n\t\t\trow.addItem(new SimpleItem({\n\t\t\t\tstart,\n\t\t\t\tend,\n\t\t\t\tcontent: <div className={styles.cooldown}/>,\n\t\t\t}))\n\t\t}\n\t}\n\n\tprivate addChargeItems(row: ContainerRow, history: ChargeHistoryEntry[]) {\n\t\tfor (const entry of history) {\n\t\t\tconst item = entry.delta < 0\n\t\t\t\t? new ActionItem({\n\t\t\t\t\tdepth: ItemDepth.ACTION,\n\t\t\t\t\tstart: entry.timestamp - this.parser.pull.timestamp,\n\t\t\t\t\taction: entry.action,\n\t\t\t\t})\n\t\t\t\t: new ChargeGainItem({\n\t\t\t\t\tdepth: ItemDepth.CHARGE_GAIN,\n\t\t\t\t\tstart: entry.timestamp - this.parser.pull.timestamp,\n\t\t\t\t})\n\t\t\trow.addItem(item)\n\t\t}\n\t}\n\n\tprivate getCooldownDuration(entry: CooldownHistoryEntry) {\n\t\tlet duration = entry.end - entry.start\n\n\t\t// If the cooldown expired naturally, it _may_ have a cast time greater than its cooldown.\n\t\tif (entry.endReason === CooldownEndReason.EXPIRED) {\n\t\t\tconst castTime = this.castTime.forAction(entry.action.id, entry.start) ?? 0\n\n\t\t\t// We add the animation lock constant to the cast time to mimic the game's\n\t\t\t// behaviour - also sometimes known as \"caster tax\".\n\t\t\tduration = Math.max(duration, castTime + ANIMATION_LOCK)\n\t\t}\n\n\t\treturn duration\n\t}\n}\n\nclass ChargeGainItem extends BaseItem {\n\tContent = () => (\n\t\t<div className={styles.chargeGain}>\n\t\t\t<Icon name=\"angle double up\" className={styles.icon}/>\n\t\t</div>\n\t)\n}\n","// extracted by mini-css-extract-plugin\nexport default {\"backgroundColour\":\"rgba(213, 221, 246, .4)\",\"chargeColor\":\"color(rgba(213, 221, 246, .4) a(100%) l(-20%))\",\"cooldown\":\"ActionTimeline-module_cooldown__3u1x3\",\"chargeGain\":\"ActionTimeline-module_chargeGain__3-Of9\",\"icon\":\"ActionTimeline-module_icon__8OvsF\"};","import {Trans} from '@lingui/react'\nimport {Action} from 'data/ACTIONS'\nimport {ANIMATION_LOCK} from 'data/CONSTANTS'\nimport {Event, Events} from 'event'\nimport {Analyser} from 'parser/core/Analyser'\nimport {filter} from 'parser/core/filter'\nimport {dependency} from 'parser/core/Injectable'\nimport CastTime from 'parser/core/modules/CastTime'\nimport Checklist, {Requirement, Rule} from 'parser/core/modules/Checklist'\nimport {Data} from 'parser/core/modules/Data'\nimport Downtime from 'parser/core/modules/Downtime'\nimport {GlobalCooldown} from 'parser/core/modules/GlobalCooldown'\nimport {SpeedAdjustments} from 'parser/core/modules/SpeedAdjustments'\nimport React from 'react'\n\nconst UPTIME_TARGET = 98\n\nexport class AlwaysBeCasting extends Analyser {\n\tstatic override handle = 'abc'\n\tstatic override debug = false\n\n\t@dependency protected castTime!: CastTime\n\t@dependency protected checklist!: Checklist\n\t@dependency protected data!: Data\n\t@dependency protected downtime!: Downtime\n\t@dependency protected globalCooldown!: GlobalCooldown\n\t@dependency protected speedAdjustments!: SpeedAdjustments\n\n\tprotected gcdUptime: number = 0\n\tprotected gcdsCounted: number = 0\n\n\tprivate lastBeginCast?: Events['prepare']\n\n\toverride initialise() {\n\t\tthis.addEventHook(\n\t\t\tfilter<Event>().source(this.parser.actor.id).type('prepare'),\n\t\t\tthis.onBeginCast\n\t\t)\n\t\tthis.addEventHook(\n\t\t\tfilter<Event>().source(this.parser.actor.id).type('action'),\n\t\t\tthis.onCast\n\t\t)\n\t\tthis.addEventHook('complete', this.onComplete)\n\t}\n\n\tprivate onBeginCast(event: Events['prepare']) {\n\t\tthis.lastBeginCast = event\n\t}\n\n\tprivate onCast(event: Events['action']) {\n\t\tconst action = this.data.getAction(event.action)\n\n\t\tif (action == null || action.onGcd == null || !action.onGcd) {\n\t\t\treturn\n\t\t}\n\n\t\tlet castTime = this.castTime.forEvent(event) ?? 0\n\t\tconst adjustedBaseGCD = this.globalCooldown.getDuration()\n\t\tif (castTime >= adjustedBaseGCD) {\n\t\t\t// Account for \"caster tax\" - animation lock on spells with cast time equal to or greater than the GCD that prevents starting the next spell until the animation finishes\n\t\t\tcastTime += ANIMATION_LOCK\n\t\t}\n\t\tconst recastTime = this.castTime.recastForEvent(event) ?? 0\n\n\t\tconst castStart = (this.lastBeginCast != null && this.lastBeginCast.action === event.action) ? this.lastBeginCast.timestamp : event.timestamp\n\t\tif (this.considerCast(action, castStart)) {\n\t\t\tconst relativeTimestamp = event.timestamp - this.parser.pull.timestamp\n\t\t\tif (castTime > relativeTimestamp) {\n\t\t\t\tthis.debug(`GCD Uptime for precast ${action.name} at ${this.parser.formatEpochTimestamp(event.timestamp, 1)} - Cast time: ${castTime} | Recast time: ${recastTime} | Time of completion: ${relativeTimestamp}`)\n\t\t\t\tthis.gcdUptime += Math.max(0, relativeTimestamp)\n\t\t\t} else {\n\t\t\t\tthis.debug(`GCD Uptime for ${action.name} at ${this.parser.formatEpochTimestamp(event.timestamp, 1)} - Cast time: ${castTime} | Recast time: ${recastTime}`)\n\t\t\t\tthis.gcdUptime += Math.max(castTime, recastTime)\n\t\t\t}\n\t\t\tthis.gcdsCounted += 1\n\t\t} else {\n\t\t\tthis.debug(`Excluding cast of ${action.name} at ${this.parser.formatEpochTimestamp(event.timestamp, 1)}`)\n\t\t}\n\t\tthis.lastBeginCast = undefined\n\t}\n\n\t/**\n\t * Implementing modules MAY override this to return false and exclude certain events from GCD uptime calculations.\n\t * By default, returns true if the cast did not start during downtime\n\t * @param action Action being considered for GCD uptime\n\t * @param timestamp Timestamp the action occurred at\n\t * @param castTime Calculated cast time of the action (adjusted by speed modifiers, if any active)\n\t */\n\tprotected considerCast(_action: Action, castStart: number) {\n\t\treturn !this.downtime.isDowntime(castStart)\n\t}\n\n\tprotected getUptimePercent(): number {\n\t\tthis.debug(`Observed ${this.gcdsCounted} GCDs for a total of ${this.gcdUptime} ms of uptime`)\n\t\tconst fightDuration = this.parser.currentDuration - this.downtime.getDowntime()\n\t\tconst uptime = this.gcdUptime / fightDuration * 100\n\t\tthis.debug(`Total fight duration: ${this.parser.currentDuration} - Downtime: ${this.downtime.getDowntime()} - Uptime percentage ${uptime}`)\n\t\treturn uptime\n\t}\n\n\tprotected onComplete() {\n\t\tif (this.gcdUptime === 0) {\n\t\t\treturn\n\t\t}\n\n\t\tthis.checklist.add(new Rule({\n\t\t\tname: <Trans id=\"core.always-cast.title\">Always be casting</Trans>,\n\t\t\tdescription: <Trans id=\"core.always-cast.description\">\n\t\t\t\tMake sure you're always doing something. It's often better to make small\n\t\t\t\tmistakes while keeping the GCD rolling than it is to perform the correct\n\t\t\t\trotation slowly.\n\t\t\t</Trans>,\n\t\t\tdisplayOrder: -1,\n\t\t\trequirements: [\n\t\t\t\tnew Requirement({\n\t\t\t\t\tname: <Trans id=\"core.always-cast.gcd-uptime\">GCD Uptime</Trans>,\n\t\t\t\t\tpercent: this.getUptimePercent(),\n\t\t\t\t}),\n\t\t\t],\n\t\t\ttarget: UPTIME_TARGET,\n\t\t}))\n\t}\n}\n","import {Status} from 'data/STATUSES'\nimport {Event, Events} from 'event'\nimport {Analyser} from 'parser/core/Analyser'\nimport {filter, oneOf} from 'parser/core/filter'\nimport {dependency} from 'parser/core/Injectable'\nimport {Actor, Actors} from 'parser/core/modules/Actors'\nimport {Data} from 'parser/core/modules/Data'\nimport {Invulnerability} from 'parser/core/modules/Invulnerability'\nimport {Statuses} from 'parser/core/modules/Statuses'\n\nconst MILLISECONDS_PER_MINUTE = 60000\n\ntype DotTracking = Map<Status['id'], Map<Actor['id'], DotTargetTracking>>\ninterface DotTargetTracking {\n\tlastApplied: number\n\ttotalClipping: number\n}\n\nexport abstract class DoTs extends Analyser {\n\tstatic override handle = 'dots'\n\n\t@dependency protected data!: Data\n\t@dependency private actors!: Actors\n\t@dependency private invulnerability!: Invulnerability\n\t@dependency private statuses!: Statuses\n\n\t/** Implementing modules MUST override this with a list of Status IDs. */\n\tprotected abstract trackedStatuses: number[] = []\n\n\tprivate statusApplications: DotTracking = new Map<number, Map<string, DotTargetTracking>>()\n\n\toverride initialise() {\n\t\tthis.addEventHook(\n\t\t\tfilter<Event>()\n\t\t\t\t.type('statusApply')\n\t\t\t\t.source(this.parser.actor.id)\n\t\t\t\t.status(oneOf(this.trackedStatuses)),\n\t\t\tthis.onApply,\n\t\t)\n\n\t\tthis.addEventHook('complete', this.onComplete)\n\t}\n\n\t/**\n\t * Implementing modules MUST override this to configure the checklist.\n\t * This should be handled on a job-by-job basis rather than generically, since the description\n\t * text isn't one-size-fits-all, and some jobs may have custom targets.\n\t */\n\tprotected abstract addChecklistRules(): void\n\n\t/**\n\t * Implementing modules MUST override this to configure suggestions.\n\t * This should be handled on a job-by-job basis rather than generically, since different jobs have\n\t * different thresholds for what constitutes bad clipping with varying explanations as to why.\n\t */\n\tprotected abstract addClippingSuggestions(): void\n\n\t/**\n\t * Implementing modules can optionally exclude applications of a status from clipping calculations.\n\t * (e.g. SMN rushing)\n\t */\n\tprotected excludeApplication() {\n\t\treturn false\n\t}\n\n\tprivate onApply(event: Events['statusApply']) {\n\t\tconst status = this.data.getStatus(event.status)\n\t\t// Cannot track for statuses that are not defined with a duration\n\t\tif (status?.duration == null) { return }\n\n\t\t// Get the tracking object for this status\n\t\tlet trackedStatus = this.statusApplications.get(status.id)\n\t\tif (trackedStatus == null) {\n\t\t\ttrackedStatus = new Map<string, DotTargetTracking>()\n\t\t\tthis.statusApplications.set(status.id, trackedStatus)\n\t\t}\n\n\t\t// Get the tracking object for this status on this target\n\t\tconst target = event.target\n\t\tlet trackedStatusOnTarget = trackedStatus.get(target)\n\t\tif (trackedStatusOnTarget == null) {\n\t\t\ttrackedStatusOnTarget = {lastApplied: 0, totalClipping: 0}\n\t\t\ttrackedStatus.set(target, trackedStatusOnTarget)\n\t\t}\n\n\t\t// If it's not been applied yet or should be excluded per job-specific logic (if any), set it and skip out\n\t\tif (trackedStatusOnTarget.lastApplied === 0 || this.excludeApplication()) {\n\t\t\ttrackedStatusOnTarget.lastApplied = event.timestamp\n\t\t\treturn\n\t\t}\n\n\t\t// Base clip calc\n\t\tconst clip = status.duration - (event.timestamp - trackedStatusOnTarget.lastApplied)\n\t\t// Cap clip at 0 - less than that is downtime, which is handled by the checklist requirement\n\t\ttrackedStatusOnTarget.totalClipping += Math.max(0, clip)\n\t\ttrackedStatusOnTarget.lastApplied = event.timestamp\n\t}\n\n\tprivate onComplete() {\n\t\tthis.addChecklistRules()\n\t\tthis.addClippingSuggestions()\n\t}\n\n\t// These two functions are helpers for submodules and should be used but not overridden\n\tprotected getUptimePercent(statusId: number) {\n\t\tconst status = this.data.getStatus(statusId)\n\t\tif (status == null) { return 0 }\n\n\t\tconst statusUptime = this.statuses.getUptime(status, this.actors.foes)\n\t\tconst fightDuration = this.parser.pull.duration - this.invulnerability.getDuration({types: ['invulnerable']})\n\t\treturn (statusUptime / fightDuration) * 100\n\t}\n\n\t// This normalises clipping as milliseconds clipped per minute,\n\t// since some level of clipping is expected and we need tiers that work for both long and short fights\n\tprotected getClippingAmount(statusId: number) {\n\t\tconst fightDuration = (this.parser.pull.duration - this.invulnerability.getDuration({types: ['invulnerable']}))\n\t\tif (fightDuration <= 0) { return 0 }\n\n\t\tconst statusApplications = this.statusApplications.get(statusId)\n\t\tif (statusApplications == null) { return 0 }\n\n\t\tconst totalClipping = Array.from(statusApplications.values()).reduce((clip, target) => clip + target.totalClipping, 0)\n\t\tconst clipMSPerMin = Math.round(totalClipping / (fightDuration / MILLISECONDS_PER_MINUTE))\n\t\treturn clipMSPerMin\n\t}\n}\n","import {MessageDescriptor} from '@lingui/core'\nimport {t} from '@lingui/macro'\nimport {Trans} from '@lingui/react'\nimport TransMarkdown from 'components/ui/TransMarkdown'\nimport {BASE_GCD} from 'data/CONSTANTS'\nimport React from 'react'\nimport {Report} from 'report'\nimport {Analyser} from '../Analyser'\nimport {dependency} from '../Injectable'\nimport {Data} from './Data'\nimport {SpeedAdjustments} from './SpeedAdjustments'\nimport {SimpleStatistic, Statistics} from './Statistics'\n\nconst estimateHelp: Record<Report['meta']['source'] | '__all', MessageDescriptor> = {\n\t__all: t('core.gcd.no-statistics.v2')`This GCD recast is an *estimate*, and may be incorrect. If it is reporting a GCD recast *longer* than reality, you likely need to focus on keeping your GCD rolling.`,\n\tlegacyFflogs: t('core.gcd.estimate-help.fflogs')`Precise attribute values are only available from FF Logs for the player who logged the report in ACT.`,\n}\n\nexport class GlobalCooldown extends Analyser {\n\tstatic override handle = 'gcd'\n\n\t@dependency private data!: Data\n\t@dependency private statistics!: Statistics\n\t@dependency private speedAdjustments!: SpeedAdjustments\n\n\toverride initialise() {\n\t\tthis.addEventHook('complete', this.onComplete)\n\t}\n\n\t/**\n\t * Get the base recast time of the parsed actor's GCD cooldown group, in milliseconds.\n\t * The value returned from this function _may_ be an estimate - check {@link GlobalCooldown.isEstimated}\n\t * to see if it is.\n\t */\n\tpublic getDuration() {\n\t\treturn this.speedAdjustments.getAdjustedDuration({duration: BASE_GCD})\n\t}\n\n\t/** Returns whether the GCD duration calculated by this module is an estimate. */\n\tpublic isEstimated() {\n\t\treturn this.speedAdjustments.isAdjustmentEstimated()\n\t}\n\n\tprivate onComplete() {\n\t\tconst estimated = this.isEstimated()\n\n\t\tthis.statistics.add(new SimpleStatistic({\n\t\t\ttitle: estimated\n\t\t\t\t? <Trans id=\"core.gcd.estimated-gcd\">Estimated GCD</Trans>\n\t\t\t\t: <Trans id=\"core.gcd.gcd\">GCD Recast</Trans>,\n\t\t\ticon: this.data.actions.ATTACK.icon,\n\t\t\tvalue: this.parser.formatDuration(this.getDuration()),\n\t\t\tinfo: estimated ? <>\n\t\t\t\t<TransMarkdown source={estimateHelp.__all}/>\n\t\t\t\t<TransMarkdown source={estimateHelp[this.parser.report.meta.source]}/>\n\t\t\t</> : undefined,\n\t\t}))\n\t}\n}\n","import {Status, StatusKey} from 'data/STATUSES'\nimport {Events} from 'event'\nimport {ensureArray} from 'utilities'\nimport {Analyser} from '../Analyser'\nimport {dependency} from '../Injectable'\nimport {Actor, StatusEvent} from './Actors'\nimport {Data} from './Data'\nimport {Invulnerability} from './Invulnerability'\n\ninterface Edge {\n\tside: 'apply' | 'remove'\n\ttimestamp: number\n}\n\nexport class Statuses extends Analyser {\n\tstatic override handle = 'statuses'\n\tstatic override debug = false\n\n\t@dependency private readonly data!: Data\n\t@dependency private readonly invulnerability!: Invulnerability\n\n\t/**\n\t * Calculate the total uptime of the specified status across allspecified actors.\n\t * @param statusSpecifier Status to calculate uptime of.\n\t * @param targetSpecifier Target(s) that should be checked for the status.\n\t * @param source Source of statuses to filter by. Defaults to the parsed actor.\n\t */\n\tgetUptime(\n\t\tstatusSpecifier: StatusKey | Status,\n\t\ttargetSpecifier: Actor | Actor[],\n\t\tsource = this.parser.actor\n\t) {\n\t\t// Resolve arguments.\n\t\tconst status = typeof statusSpecifier === 'string'\n\t\t\t? this.data.statuses[statusSpecifier]\n\t\t\t: statusSpecifier\n\n\t\tconst targets = ensureArray(targetSpecifier)\n\n\t\t// Collect all the status history for the specified status/target/source combo.\n\t\tconst edges = targets.flatMap(target => this.edgesForActor(\n\t\t\ttarget,\n\t\t\ttarget.statusHistory.get(status.id)?.get(source.id) ?? []\n\t\t))\n\n\t\t// Edges are mapped from multiple potential targets; interlace by sorting by timestamp.\n\t\tedges.sort((a, b) => a.timestamp - b.timestamp)\n\n\t\t// Sum time when any of the specified targets had the status.\n\t\tconst meta = {uptime: 0, depth: 0, application: 0}\n\t\tfor (const edge of edges) {\n\t\t\tif (edge.side === 'apply') {\n\t\t\t\tif (meta.depth === 0) {\n\t\t\t\t\tmeta.application = edge.timestamp\n\t\t\t\t}\n\t\t\t\tmeta.depth ++\n\n\t\t\t} else {\n\t\t\t\tmeta.depth --\n\t\t\t\tif (meta.depth === 0) {\n\t\t\t\t\tmeta.uptime += edge.timestamp - meta.application\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.debug(`Status ${status.name} ${edge.side} at ${this.ft(edge.timestamp)}, depth=${meta.depth}`)\n\t\t}\n\n\t\treturn meta.uptime\n\t}\n\n\tprivate edgesForActor(target: Actor, events: StatusEvent[]) {\n\t\t// We can safely assume status events from an actor will alternate between apply and remove.\n\t\tconst edges: Edge[] = []\n\t\tlet apply: Events['statusApply'] | undefined\n\t\tlet refresh: Events['statusApply'] | undefined\n\n\t\tfor (const event of events) {\n\t\t\t// Track the initial application and refreshes.\n\t\t\tif (event.type === 'statusApply') {\n\t\t\t\tapply ??= event\n\t\t\t\trefresh = event\n\t\t\t\tcontinue\n\t\t\t}\n\n\t\t\tif (apply == null) {\n\t\t\t\tcontinue\n\t\t\t}\n\n\t\t\t// Window has been closed, merge any edges in.\n\t\t\tedges.push(...this.splitRangeForInvulns(\n\t\t\t\ttarget,\n\t\t\t\tapply.timestamp,\n\t\t\t\tevent.timestamp\n\t\t\t))\n\t\t\tapply = undefined\n\t\t}\n\n\t\t// If we've got a dangling apply, build edges for it.\n\t\tif (apply != null) {\n\t\t\t// Try to find a reasonable remove time for the status, if it has a duration.  Cap to the end of the fight.\n\t\t\tconst statusDuration = this.data.getStatus(apply.status)?.duration\n\t\t\tconst remove = statusDuration == null\n\t\t\t\t? this.parser.currentEpochTimestamp\n\t\t\t\t: Math.min((refresh ?? apply).timestamp + statusDuration, this.parser.currentEpochTimestamp)\n\n\t\t\tedges.push(...this.splitRangeForInvulns(\n\t\t\t\ttarget,\n\t\t\t\tapply.timestamp,\n\t\t\t\tremove,\n\t\t\t))\n\t\t}\n\n\t\treturn edges\n\t}\n\n\tprivate splitRangeForInvulns(target: Actor, apply: number, remove: number): Edge[] {\n\t\tlet range = {apply, remove}\n\t\tconst finalRanges = [range]\n\n\t\t// Get the invuln windows that occured during this range\n\t\tconst invulns = this.invulnerability.getWindows({\n\t\t\tstart: apply,\n\t\t\tend: remove,\n\t\t\tactorFilter: actor => actor.kind === target.kind,\n\t\t\ttypes: ['invulnerable'],\n\t\t})\n\n\t\tfor (const invuln of invulns) {\n\t\t\t// Invuln clipped start of range.\n\t\t\tif (invuln.start < range.apply && invuln.end >= range.apply) {\n\t\t\t\tthis.debug(`Start clip, [${this.ft(range.apply)},${this.ft(range.remove)}] -> [${this.ft(invuln.end)},${this.ft(range.remove)}]`)\n\n\t\t\t\trange.apply = invuln.end\n\t\t\t\tcontinue\n\t\t\t}\n\n\t\t\t// Invuln clipped end of range.\n\t\t\tif (invuln.start <= range.remove && invuln.end > range.remove) {\n\t\t\t\tthis.debug(`End clip, [${this.ft(range.apply)},${this.ft(range.remove)}] -> [${this.ft(range.apply)},${this.ft(invuln.start)}]`)\n\n\t\t\t\trange.remove = invuln.start\n\t\t\t\tcontinue\n\t\t\t}\n\n\t\t\t// Everything else should be a range split, sanity check.\n\t\t\tif (invuln.start < range.apply || invuln.end > range.remove) {\n\t\t\t\tcontinue\n\t\t\t}\n\n\t\t\tthis.debug(`Split [${this.ft(range.apply)},${this.ft(range.remove)}] -> [${this.ft(range.apply)},${this.ft(invuln.start)}], [${this.ft(invuln.end)},${this.ft(range.remove)}]`)\n\n\t\t\t// Split the range into two around the invuln.\n\t\t\tconst previousRange = range\n\t\t\trange = {...range}\n\t\t\tfinalRanges.push(range)\n\n\t\t\tpreviousRange.remove = invuln.start\n\t\t\trange.apply = invuln.end\n\t\t}\n\n\t\t// Map the ranges into edges.\n\t\treturn finalRanges.flatMap(range => [\n\t\t\t{side: 'apply', timestamp: range.apply},\n\t\t\t{side: 'remove', timestamp: range.remove},\n\t\t] as const)\n\t}\n\n\t// Small utility for formatting timestamps, as we do it a _lot_ in debug messages\n\tprivate ft = (timestamp: number) => this.parser.formatEpochTimestamp(timestamp, 1)\n}\n","import {ActionRow, ActionTimeline as CoreActionTimeline} from 'parser/core/modules/ActionTimeline'\n\nexport class ActionTimeline extends CoreActionTimeline {\n\tstatic override rows: ActionRow[] = [\n\t\t...CoreActionTimeline.rows,\n\t\t'BARRAGE',\n\t\t'RAGING_STRIKES',\n\t\t'BATTLE_VOICE',\n\t\t'RADIANT_FINALE',\n\t\t'BLOODLETTER',\n\t\t{\n\t\t\tlabel: 'Songs',\n\t\t\tcontent: [\n\t\t\t\t'THE_WANDERERS_MINUET',\n\t\t\t\t'MAGES_BALLAD',\n\t\t\t\t'ARMYS_PAEON',\n\t\t\t],\n\t\t},\n\t\t'EMPYREAL_ARROW',\n\t\t'SIDEWINDER',\n\t\t'PITCH_PERFECT',\n\t\t'TROUBADOUR',\n\t\t'NATURES_MINNE',\n\t\t'THE_WARDENS_PAEAN',\n\t\t'REPELLING_SHOT',\n\t]\n}\n","import {Action} from 'data/ACTIONS'\nimport {Event, Events} from 'event'\nimport {filter, oneOf} from 'parser/core/filter'\nimport {AlwaysBeCasting as CoreAlwaysBeCasting} from 'parser/core/modules/AlwaysBeCasting'\n\ninterface ArmyWindow {\n\tstart: number\n\tend: number\n}\n\nexport class AlwaysBeCasting extends CoreAlwaysBeCasting {\n\tprivate armyHistory: ArmyWindow[] = []\n\tprivate currentArmy: ArmyWindow | undefined = undefined\n\n\toverride initialise() {\n\t\tsuper.initialise()\n\n\t\tconst armyFilter = filter<Event>()\n\t\t\t.source(this.parser.actor.id)\n\t\t\t.status(oneOf([this.data.statuses.ARMYS_MUSE.id, this.data.statuses.ARMYS_PAEON.id]))\n\n\t\tthis.addEventHook(armyFilter.type('statusApply'), this.onApplyArmy)\n\t\tthis.addEventHook(armyFilter.type('statusRemove'), this.onRemoveArmy)\n\t}\n\n\tprivate onApplyArmy(event: Events['statusApply']) {\n\t\tif (this.currentArmy != null) { return }\n\n\t\tthis.currentArmy = {\n\t\t\tstart: event.timestamp,\n\t\t\tend: this.parser.pull.timestamp + this.parser.pull.duration,\n\t\t}\n\n\t\tthis.armyHistory.push(this.currentArmy)\n\t}\n\n\tprivate onRemoveArmy(event: Events['statusRemove']) {\n\t\tif (this.currentArmy != null) {\n\t\t\tthis.currentArmy.end = event.timestamp\n\t\t\tthis.currentArmy = undefined\n\t\t}\n\t}\n\n\toverride considerCast(action: Action, castStart: number): boolean {\n\t\t// Because Army's Paeon and Army's Muse reduce GCD speed by a variable amount that we can't synthesize, we exclude skills used under either buff from GCD uptime analysis\n\t\tif (this.currentArmy != null)  {\n\t\t\tthis.debug(`Army's buff active at ${this.parser.formatEpochTimestamp(castStart)}`)\n\t\t\treturn false\n\t\t}\n\n\t\treturn super.considerCast(action, castStart)\n\t}\n\n\toverride getUptimePercent(): number {\n\t\tthis.debug(`Observed ${this.gcdsCounted} GCDs for a total of ${this.gcdUptime} ms of uptime`)\n\t\tconst fightDuration = this.parser.currentDuration - this.downtime.getDowntime()\n\t\tconst armyDuration = this.armyHistory.reduce((acc, army) => {\n\t\t\tconst downtime = this.downtime.getDowntime(\n\t\t\t\tarmy.start,\n\t\t\t\tarmy.end,\n\t\t\t)\n\t\t\treturn acc + army.end - army.start - downtime\n\t\t}, 0)\n\t\t// Because Army's Paeon and Army's Muse reduce GCD speed by a variable amount that we can't synthesize, we exclude time under either buff from GCD uptime analysis\n\t\tconst uptime = this.gcdUptime / (fightDuration - armyDuration) * 100\n\t\tthis.debug(`Total fight duration: ${this.parser.currentDuration} - Downtime: ${this.downtime.getDowntime()} - Army's Paeon or Muse active: ${armyDuration} - Uptime percentage ${uptime}`)\n\n\t\treturn uptime\n\t}\n}\n","import {Trans} from '@lingui/react'\nimport {ActionLink, StatusLink} from 'components/ui/DbLink'\nimport {dependency} from 'parser/core/Injectable'\nimport Checklist, {Requirement, TARGET, TieredRule} from 'parser/core/modules/Checklist'\nimport {DoTs as CoreDoTs} from 'parser/core/modules/DoTs'\nimport Suggestions, {SEVERITY, TieredSuggestion} from 'parser/core/modules/Suggestions'\nimport React from 'react'\n\n// Bard clips ~15s every 120s rotationally\nconst SEVERITIES = {\n\tCLIPPING: {\n\t\t10000: SEVERITY.MINOR,\n\t\t15000: SEVERITY.MEDIUM,\n\t\t20000: SEVERITY.MAJOR,\n\t},\n\tUPTIME: {\n\t\t85: TARGET.WARN,\n\t\t95: TARGET.SUCCESS,\n\t},\n}\n\nexport class DoTs extends CoreDoTs {\n\t@dependency private checklist!: Checklist\n\t@dependency private suggestions!: Suggestions\n\n\tprotected override trackedStatuses = [\n\t\tthis.data.statuses.CAUSTIC_BITE.id,\n\t\tthis.data.statuses.STORMBITE.id,\n\t]\n\n\tprotected override addChecklistRules() {\n\t\tthis.checklist.add(new TieredRule({\n\t\t\tname: <Trans id=\"brd.dots.checklist.name\">Keep your DoTs up</Trans>,\n\t\t\tdescription: <Trans id=\"brd.dots.checklist.description\">A significant amount of Bard's DPS comes from <ActionLink {...this.data.actions.CAUSTIC_BITE}/> and <ActionLink {...this.data.actions.STORMBITE}/>.\n\t\t\t\tMake sure you have these skills applied on the target at all times. Use <ActionLink {...this.data.actions.IRON_JAWS}/> to refresh the timer on the Damage over Time (DoT) debuff.\n\t\t\t</Trans>,\n\t\t\ttiers: SEVERITIES.UPTIME,\n\t\t\trequirements: [\n\t\t\t\tnew Requirement({\n\t\t\t\t\tname: <Trans id=\"brd.dots.checklist.requirement.caustic\"><StatusLink {...this.data.statuses.CAUSTIC_BITE} /> uptime</Trans>,\n\t\t\t\t\tpercent: () => this.getUptimePercent(this.data.statuses.CAUSTIC_BITE.id),\n\t\t\t\t}),\n\t\t\t\tnew Requirement({\n\t\t\t\t\tname: <Trans id=\"brd.dots.checklist.requirement.storm\"><StatusLink {...this.data.statuses.STORMBITE} /> uptime</Trans>,\n\t\t\t\t\tpercent: () => this.getUptimePercent(this.data.statuses.STORMBITE.id),\n\t\t\t\t}),\n\t\t\t],\n\t\t}))\n\t}\n\n\tprotected addClippingSuggestions() {\n\t\t// DoTs are meant to be refreshed together, so just average their clip\n\t\tconst meanClip = (this.getClippingAmount(this.data.statuses.CAUSTIC_BITE.id) + this.getClippingAmount(this.data.statuses.STORMBITE.id)) / 2\n\n\t\tthis.suggestions.add(new TieredSuggestion({\n\t\t\ticon: this.data.actions.IRON_JAWS.icon,\n\t\t\tcontent: <Trans id=\"brd.dots.suggestion.clip.content\">\n\t\t\t\t\tAvoid refreshing <ActionLink {...this.data.actions.CAUSTIC_BITE} /> and <ActionLink {...this.data.actions.STORMBITE} /> significantly before they expire.\n\t\t\t</Trans>,\n\t\t\twhy: <Trans id=\"brd.dots.suggestion.clip.why\">\n\t\t\t\t\t\tAn average of {this.parser.formatDuration(meanClip)} of DoTs clipped per minute due to early refreshes.\n\t\t\t</Trans>,\n\t\t\ttiers: SEVERITIES.CLIPPING,\n\t\t\tvalue: meanClip,\n\t\t}))\n\t}\n}\n","//                     Lv.89 DRIFTING EA\n//\n//                          ``......`\n//                 `-:+sydmNNNNNNNNNNNmdys+:.\n//             .:ohmNMMMMMMMMMMMMMMMMMMMMMMMNmy+-\n//          .+hNMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMNdo.\n//       `:hNMMMMMMMMMMMMMMMMMMMMMMMMMMNmmmNMMMMMMMNy-\n//      /dMMMMMMMMMMMMMMMMMMMMMMMMMMms:-....:ohNMMMMMNs.\n//    .yMMMMMMMMMMMMMMMMMMMMMMMMMMMs.          .omMMMMMm/\n//   -mMMMMMMMMMMMMMMMMMMMMMMMMMMMs          --. .sNMMMMMs`\n//  .mMMMMMMMMMMMMMMMMMMMMMMMMMMMM. yhy:    :MMNs  :NMMMMMy`\n//  hMMMMMMMMMMMMMMMMMMMMMMMMMMMMM. mMMM:   `hMMM.  :MMMMMMo\n// -MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMo .yNN/    `:o+    sMMMMMM-\n// oMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM/  ``             .MMMMMMy\n// sMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMs`                dMMMMMM`\n// +MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMm-               sMMMMMM:\n// .MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMo              /MMMMMM+\n//  hMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMh`            :MMMMMMo\n//  .MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMd.           -MMMMMM:\n//   +MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMd`          -MMMMMN`\n//    yMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMh          -MMMMMo\n//    `dMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM/         -MMMMN.\n//     .mMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMo         .MMMMy\n//      -NMMMMMMMMMMMMMMMMMyNMMMMMMMMMMMMMMM:         .MMMM:\n//       :NMMMMMMMMMMMMMMMMd-hMMMMdoMMMMMMMN`         `MMMM`\n//        /NMMMMMMMhhMMMMMMM/`:so:` NMMMMMMd           NMMN\n//         /NMMMMMMy /mMN++hd`      oMMMMMMm           yMMM\n//          /NMMMMMo  `+h   .`       +NMMMMM/          -MMM`\n//           +MMMMM-                  .sNMMMN-          +MM:\n//            dMMM+                     .omMMm.          +Ns\n//            :Mm:                         :smm-          ./\n//             /                              -+-\n\nimport {t} from '@lingui/macro'\nimport {Trans} from '@lingui/react'\nimport Tooltip, {ActionLink} from 'components/ui/DbLink'\nimport {Event, Events} from 'event'\nimport {Analyser} from 'parser/core/Analyser'\nimport {filter} from 'parser/core/filter'\nimport {dependency} from 'parser/core/Injectable'\nimport {Data} from 'parser/core/modules/Data'\nimport Downtime from 'parser/core/modules/Downtime'\nimport {Timeline} from 'parser/core/modules/Timeline'\nimport React, {Fragment} from 'react'\nimport {Button, Message, Table} from 'semantic-ui-react'\n\n// Buffer (ms) to forgive insignificant drift\nconst DRIFT_BUFFER = 2000\n\n// Buffer (ms) to allow for reopeners after a downtime\nconst REOPENER_BUFFER = 4000\nconst MIN_REOPENER_DOWNTIME = 15000\n\n// Timeline padding to see the drifted oGCD when you jump to the window\nconst TIMELINE_PADDING = 2500\n\ninterface DriftWindow {\n\tstart: number\n}\n\ninterface ConfirmedDriftWindow extends DriftWindow {\n\tdriftedActionId: number\n\tdrift: number\n\tend: number\n}\n\nexport class DriftingEa extends Analyser {\n\tstatic override handle = 'drifting-ea'\n\tstatic override title = t('brd.drifting-ea.title')`Empyreal Arrow Drift`\n\n\t@dependency private data!: Data\n\t@dependency private downtime!: Downtime\n\t@dependency private timeline!: Timeline\n\n\tprivate driftedWindows: ConfirmedDriftWindow[] = []\n\n\tprivate currentWindow: DriftWindow =  {\n\t\tstart: this.parser.pull.timestamp,\n\t}\n\n\toverride initialise() {\n\t\tconst eaId = this.data.actions.EMPYREAL_ARROW.id\n\n\t\tconst castFilter = filter<Event>()\n\t\t\t.type('action')\n\t\t\t.source(this.parser.actor.id)\n\n\t\tthis.addEventHook(castFilter.action(eaId), this.onDriftableCast)\n\t}\n\n\tprivate onDriftableCast(event: Events['action']) {\n\t\tconst action = this.data.getAction(event.action)\n\n\t\tif (!action || !action.cooldown) { return }\n\n\t\tconst window = this.currentWindow\n\t\tconst observedUseTime = event.timestamp\n\n\t\t// Cap at this event's timestamp, just in case\n\t\tconst earliestUseTime = Math.min(window.start + action.cooldown, observedUseTime)\n\n\t\tlet expectedUseTime = earliestUseTime\n\n\t\t// Increase the expected use time if it was in downtime\n\t\tif (this.downtime.isDowntime(earliestUseTime)) {\n\t\t\tconst downtimeWindow = this.downtime.getDowntimeWindows(window.start, observedUseTime)[0]\n\t\t\texpectedUseTime = downtimeWindow.end\n\n\t\t\t// Forgive \"drift\" due to reopening with other actions after downtime\n\t\t\tif (downtimeWindow.end - downtimeWindow.start > MIN_REOPENER_DOWNTIME) {\n\t\t\t\texpectedUseTime += REOPENER_BUFFER\n\t\t\t}\n\t\t}\n\n\t\tconst drift = Math.max(0, observedUseTime - expectedUseTime)\n\n\t\t// Forgive a small amount of drift\n\t\tif (drift > DRIFT_BUFFER) {\n\t\t\tthis.driftedWindows.push({\n\t\t\t\t...window,\n\t\t\t\tdriftedActionId: event.action,\n\t\t\t\tdrift: drift,\n\t\t\t\tend: observedUseTime,\n\t\t\t})\n\t\t}\n\n\t\t// Begin the next window\n\t\tthis.currentWindow = {\n\t\t\tstart: observedUseTime,\n\t\t}\n\t}\n\n\toverride output() {\n\t\t// Nothing to show\n\t\tif (!this.driftedWindows.length) { return }\n\n\t\tconst driftTable = <Table collapsing unstackable compact=\"very\">\n\t\t\t<Table.Header>\n\t\t\t\t<Table.Row>\n\t\t\t\t\t<Table.HeaderCell><Trans id=\"brd.drifting-ea.timestamp-header\">Timestamp</Trans></Table.HeaderCell>\n\t\t\t\t\t<Table.HeaderCell><Trans id=\"brd.drifting-ea.drift-header\">Drift Issue</Trans></Table.HeaderCell>\n\t\t\t\t\t<Table.HeaderCell></Table.HeaderCell>\n\t\t\t\t</Table.Row>\n\t\t\t</Table.Header>\n\t\t\t<Table.Body>\n\t\t\t\t{this.driftedWindows.map(window => {\n\t\t\t\t\treturn <Table.Row key={window.start}>\n\t\t\t\t\t\t<Table.Cell>{this.parser.formatEpochTimestamp(window.end)}</Table.Cell>\n\t\t\t\t\t\t<Table.Cell>\n\t\t\t\t\t\t\t<Trans id=\"brd.drifting-ea.drift-issue\">\n\t\t\t\t\t\t\t\t<ActionLink {...this.data.getAction(window.driftedActionId)}/> drifted by {this.parser.formatDuration(window.drift)}\n\t\t\t\t\t\t\t</Trans>\n\t\t\t\t\t\t</Table.Cell>\n\t\t\t\t\t\t<Table.Cell>\n\t\t\t\t\t\t\t<Button onClick={() =>\n\t\t\t\t\t\t\t\tthis.timeline.show(window.start - this.parser.pull.timestamp, window.end + TIMELINE_PADDING - this.parser.pull.timestamp)}>\n\t\t\t\t\t\t\t\t<Trans id=\"brd.drifting-ea.timelinelink-button\">Jump to Timeline</Trans>\n\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t</Table.Cell>\n\t\t\t\t\t</Table.Row>\n\t\t\t\t})}\n\t\t\t</Table.Body>\n\t\t</Table>\n\n\t\treturn <Fragment>\n\t\t\t<Message>\n\t\t\t\t<Trans id=\"brd.drifting-ea.accordion.message\">\n\t\t\t\t\t<ActionLink action=\"EMPYREAL_ARROW\"/> is your most valuable oGCD thanks to <Tooltip sheet=\"Trait\" id={169}/>, and should be used on cooldown.\n\t\t\t\t</Trans>\n\t\t\t</Message>\n\t\t\t{driftTable}\n\t\t</Fragment>\n\t}\n}\n","import {Defensives} from 'parser/core/modules/Defensives'\n\nexport class Mitigation extends Defensives {\n\tprotected override trackedDefensives = [\n\t\tthis.data.actions.NATURES_MINNE,\n\t\tthis.data.actions.TROUBADOUR,\n\t]\n}\n","import ACTIONS from 'data/ACTIONS'\nimport {AoEUsages} from 'parser/core/modules/AoEUsages'\nimport DISPLAY_ORDER from './DISPLAY_ORDER'\n\nexport class MultiHitSkills extends AoEUsages {\n\tstatic displayerOrder = DISPLAY_ORDER.MULTI_HIT_SKILLS\n\tsuggestionIcon = ACTIONS.LADONSBITE.icon\n\n\ttrackedActions = [\n\t\t{\n\t\t\taoeAction: ACTIONS.QUICK_NOCK,\n\t\t\tstActions: [ACTIONS.BURST_SHOT],\n\t\t\tminTargets: 2,\n\t\t}, {\n\t\t\taoeAction: ACTIONS.LADONSBITE,\n\t\t\tstActions: [ACTIONS.BURST_SHOT],\n\t\t\tminTargets: 2,\n\t\t}, {\n\t\t\taoeAction: ACTIONS.SHADOWBITE,\n\t\t\tstActions: [ACTIONS.BURST_SHOT],\n\t\t\tminTargets: 2,\n\t\t}, {\n\t\t\taoeAction: ACTIONS.RAIN_OF_DEATH,\n\t\t\tstActions: [ACTIONS.BLOODLETTER],\n\t\t\tminTargets: 2,\n\t\t},\n\t]\n}\n","export default {\n\tRAGING_STRIKES: 1,\n\tBARRAGE: 2,\n\tPITCH_PERFECT: 3,\n\tSIDEWINDER: 4,\n\tSNAPSHOTS: 5,\n\tMULTI_HIT_SKILLS: 6,\n}\n","/**\n * @author Yumiya\n */\nimport {CooldownDowntime} from 'parser/core/modules/CooldownDowntime'\n\nexport class OGCDDowntime extends CooldownDowntime {\n\toverride trackedCds = [\n\t\t{\n\t\t\tcooldowns: [this.data.actions.EMPYREAL_ARROW],\n\t\t\tfirstUseOffset: 4000,\n\t\t\tallowedAverageDowntime: 1,\n\t\t},\n\t\t{\n\t\t\tcooldowns: [this.data.actions.BATTLE_VOICE],\n\t\t\tfirstUseOffset: 7500,\n\t\t},\n\t\t{\n\t\t\tcooldowns: [this.data.actions.RADIANT_FINALE],\n\t\t\tfirstUseOffset: 7500,\n\t\t\tallowedAverageDowntime: 10000,\n\t\t},\n\t\t{\n\t\t\tcooldowns: [this.data.actions.RAGING_STRIKES],\n\t\t\tfirstUseOffset: 2500,\n\t\t},\n\t\t{\n\t\t\tcooldowns: [this.data.actions.BARRAGE],\n\t\t\tfirstUseOffset: 12000,\n\t\t},\n\t\t{\n\t\t\tcooldowns: [this.data.actions.SIDEWINDER],\n\t\t\tfirstUseOffset: 12000,\n\t\t},\n\t]\n}\n","import {t} from '@lingui/macro'\nimport {Plural, Trans} from '@lingui/react'\nimport {ActionLink, DataLink} from 'components/ui/DbLink'\nimport {RotationTargetOutcome} from 'components/ui/RotationTable'\nimport {Action, ActionKey} from 'data/ACTIONS'\nimport {Event, Events} from 'event'\nimport _ from 'lodash'\nimport {filter} from 'parser/core/filter'\nimport {dependency} from 'parser/core/Injectable'\nimport {\n\tBuffWindow,\n\tEvaluatedAction,\n\tEvaluationOutput,\n\tExpectedActionsEvaluator,\n\tExpectedActionGroupsEvaluator,\n\tExpectedGcdCountEvaluator,\n\tTrackedAction,\n\tTrackedActionsOptions,\n\tWindowEvaluator,\n} from 'parser/core/modules/ActionWindow'\nimport {HistoryEntry} from 'parser/core/modules/ActionWindow/History'\nimport {Actors} from 'parser/core/modules/Actors'\nimport {GlobalCooldown} from 'parser/core/modules/GlobalCooldown'\nimport {SEVERITY} from 'parser/core/modules/Suggestions'\nimport {SeverityTiers, TieredSuggestion} from 'parser/core/modules/Suggestions/Suggestion'\nimport React, {ReactNode} from 'react'\nimport {Team} from 'report'\nimport {Icon} from 'semantic-ui-react'\nimport {isDefined} from 'utilities'\nimport DISPLAY_ORDER from './DISPLAY_ORDER'\n\n// Minimum muse GCDs needed to expect an RS window to have 9 GCDs\nconst MIN_MUSE_GCDS = 3\n\nconst BUFF_BEST_USED_BEFORE_GCD = 3\n\nconst APEX_OPENER_BUFFER = 60000 // time it takes on average to fill the first Apex Arrow\n\nconst SUPPORT_ACTIONS: ActionKey[] = [\n\t'ARMS_LENGTH',\n\t'FOOT_GRAZE',\n\t'HEAD_GRAZE',\n\t'LEG_GRAZE',\n\t'NATURES_MINNE',\n\t'PELOTON',\n\t'REPELLING_SHOT',\n\t'SECOND_WIND',\n\t'SPRINT',\n\t'THE_WARDENS_PAEAN',\n\t'TROUBADOUR',\n]\n\ninterface MuseWindow {\n\tstart: number,\n\tend?: number | undefined,\n}\n\ninterface BarrageOptions extends TrackedActionsOptions {\n\tbarrageId: number\n\twasBarrageUsed: (window: HistoryEntry<EvaluatedAction[]>) => boolean\n}\n\nclass BarrageEvaluator extends ExpectedActionsEvaluator {\n\t// Because this class is not an Analyser, it cannot use Data directly\n\t// to get the id for Barrage, so it has to take it in here.\n\tprivate barrageId: number\n\tprivate wasBarrageUsed: (window: HistoryEntry<EvaluatedAction[]>) => boolean\n\n\tconstructor(opts: BarrageOptions) {\n\t\tsuper(opts)\n\t\tthis.barrageId = opts.barrageId\n\t\tthis.wasBarrageUsed = opts.wasBarrageUsed\n\t}\n\n\toverride countUsed(window: HistoryEntry<EvaluatedAction[]>, action: TrackedAction) {\n\t\tif (action.action.id === this.barrageId) {\n\t\t\treturn this.wasBarrageUsed(window) ? 1 : 0\n\t\t}\n\t\treturn super.countUsed(window, action)\n\t}\n}\n\ninterface BuffEvaluatorOptions {\n\tactions: Action[]\n\tgcdThreshold: number\n\n\tsuggestionIcon: string\n\tsuggestionContent: ReactNode\n\tseverityTiers: SeverityTiers\n}\n\nclass BuffEvaluator implements WindowEvaluator, BuffEvaluatorOptions {\n\tactions: Action[]\n\tgcdThreshold: number\n\n\tsuggestionIcon: string\n\tsuggestionContent: ReactNode\n\tsuggestionWhy: ReactNode\n\tseverityTiers: SeverityTiers\n\n\tconstructor(opt: BuffEvaluatorOptions) {\n\t\tthis.actions = opt.actions\n\t\tthis.gcdThreshold = opt.gcdThreshold\n\t\tthis.suggestionContent = opt.suggestionContent\n\t\tthis.suggestionIcon = opt.suggestionIcon\n\t\tthis.severityTiers = opt.severityTiers\n\t}\n\n\toutput(windows: Array<HistoryEntry<EvaluatedAction[]>>): EvaluationOutput[] {\n\t\treturn this.actions.map(it => {\n\t\t\tconst header = {\n\t\t\t\theader: <Trans id=\"brd.rs.rotation-table.header.on-time\"><ActionLink showName={false} {...it} /> On Time?</Trans>,\n\t\t\t\taccessor: it.name,\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\tformat: 'notes',\n\t\t\t\theader: header,\n\t\t\t\trows: windows.map(window => this.generateNotes(it.id, window)),\n\t\t\t}\n\t\t})\n\t}\n\n\tgenerateNotes(actionId: number, window: HistoryEntry<EvaluatedAction[]>) {\n\t\tconst usedInTime = this.wasActionUsedInTime(actionId, this.gcdThreshold, window)\n\t\treturn <Icon\n\t\t\tname={usedInTime ? 'checkmark' : 'remove'}\n\t\t\tclassName={usedInTime ? 'text-success' : 'text-error'}\n\t\t/>\n\t}\n\n\tsuggest(windows: Array<HistoryEntry<EvaluatedAction[]>>) {\n\t\tconst wrongUsages = this.actions.map(action =>\n\t\t\t// For each action, counts the amount of times skill was not used in time in every window\n\t\t\twindows.map(window => Number(!this.wasActionUsedInTime(action.id, this.gcdThreshold, window)))\n\t\t\t\t.reduce((acc, it) => acc + it, 0)\n\t\t).reduce((acc, it) => acc + it, 0)\n\n\t\treturn new TieredSuggestion({\n\t\t\ticon: this.suggestionIcon,\n\t\t\tcontent: this.suggestionContent,\n\t\t\ttiers: this.severityTiers,\n\t\t\tvalue: wrongUsages,\n\t\t\twhy: <Trans id=\"brd.rs.suggestions.buff-evaluator.why\">\n\t\t\t\t<Plural value={wrongUsages} one=\"# cast of recommended actions was\" other=\"# casts of recommended actions were\"/> used later than optimal, or not at all.\n\t\t\t</Trans>,\n\t\t})\n\t}\n\n\t/**\n\t * Checks if given {actionId} was used before GCD #{gcdThreshold}\n\t * @param actionId\n\t * @param gcdThreshold\n\t * @param window\n\t */\n\tprivate wasActionUsedInTime = (actionId: number, gcdThreshold: number, window: HistoryEntry<EvaluatedAction[]>): boolean => {\n\t\tconst buffAction = _.first(window.data.filter(it => it.action.id === actionId))\n\n\t\t// Buff was not used, thus it was not in time\n\t\tif (buffAction === undefined) { return false }\n\n\t\tconst gcdThresholdAction = _.last(\n\t\t\twindow.data\n\t\t\t\t.filter(it => it.action.onGcd)\n\t\t\t\t.slice(0, gcdThreshold)\n\t\t)\n\n\t\t// There's no limiting GCD in the window, so can only assume it was used in time\n\t\tif (gcdThresholdAction === undefined) { return true }\n\n\t\t// Used in time if it was used before specified GCD\n\t\treturn buffAction.timestamp < gcdThresholdAction.timestamp\n\t}\n}\n\nexport class RagingStrikes extends BuffWindow {\n\tstatic override handle = 'rs'\n\tstatic override title = t('brd.rs.title')`Raging Strikes`\n\tstatic override displayOrder = DISPLAY_ORDER.RAGING_STRIKES\n\n\t@dependency private globalCooldown!: GlobalCooldown\n\t@dependency private actors!: Actors\n\n\toverride buffStatus = this.data.statuses.RAGING_STRIKES\n\n\tprivate museHistory: MuseWindow[] = []\n\tprivate barrageRemoves: number[] = []\n\n\toverride initialise() {\n\t\tsuper.initialise()\n\n\t\tthis.ignoreActions(SUPPORT_ACTIONS.map(actionKey => this.data.actions[actionKey].id))\n\n\t\tconst playerFilter = filter<Event>().source(this.parser.actor.id)\n\t\tconst buffFilter = playerFilter.status(this.data.statuses.ARMYS_MUSE.id)\n\t\tthis.addEventHook(buffFilter.type('statusApply'), this.onApplyMuse)\n\t\tthis.addEventHook(buffFilter.type('statusRemove'), this.onRemoveMuse)\n\t\tthis.addEventHook(playerFilter.status(this.data.statuses.BARRAGE.id).type('statusRemove'), this.onRemoveBarrage)\n\n\t\tconst suggestionWindowName = <DataLink action=\"RAGING_STRIKES\" showIcon={false} />\n\t\tthis.addEvaluator(new ExpectedGcdCountEvaluator({\n\t\t\texpectedGcds: 8,\n\t\t\tglobalCooldown: this.globalCooldown,\n\t\t\thasStacks: false,\n\t\t\tsuggestionIcon: this.data.actions.RAGING_STRIKES.icon,\n\t\t\tsuggestionContent: <Trans id=\"brd.rs.suggestions.missedgcd.content\">\n\t\t\t\tTry to land 8 GCDs (9 GCDs with <DataLink status=\"ARMYS_MUSE\"/>) during every <DataLink action=\"RAGING_STRIKES\"/> window.\n\t\t\t</Trans>,\n\t\t\tsuggestionWindowName,\n\t\t\tseverityTiers: {\n\t\t\t\t1: SEVERITY.MINOR,\n\t\t\t\t3: SEVERITY.MEDIUM,\n\t\t\t\t5: SEVERITY.MAJOR,\n\t\t\t},\n\t\t\tadjustCount: this.adjustExpectedGcdCount.bind(this),\n\t\t}))\n\n\t\tthis.addEvaluator(new BarrageEvaluator({\n\t\t\texpectedActions: [\n\t\t\t\t{\n\t\t\t\t\taction: this.data.actions.BARRAGE,\n\t\t\t\t\texpectedPerWindow: 1,\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\taction: this.data.actions.IRON_JAWS,\n\t\t\t\t\texpectedPerWindow: 1,\n\t\t\t\t},\n\t\t\t],\n\t\t\tsuggestionIcon: this.data.actions.BARRAGE.icon,\n\t\t\tsuggestionContent: <Trans id=\"brd.rs.suggestions.trackedactions.content\">\n\t\t\t\tOne use of <DataLink action=\"BARRAGE\"/> and one use of <DataLink action=\"IRON_JAWS\"/> should occur during every <DataLink action=\"RAGING_STRIKES\"/> window.\n\t\t\t</Trans>,\n\t\t\tsuggestionWindowName,\n\t\t\tseverityTiers: {\n\t\t\t\t1: SEVERITY.MINOR,\n\t\t\t\t3: SEVERITY.MEDIUM,\n\t\t\t\t5: SEVERITY.MAJOR,\n\t\t\t},\n\t\t\tadjustCount: this.adjustExpectedActionCount.bind(this),\n\t\t\tadjustOutcome: this.adjustExpectedActionOutcome.bind(this),\n\t\t\tbarrageId: this.data.actions.BARRAGE.id,\n\t\t\twasBarrageUsed: this.wasBarrageUsed.bind(this),\n\t\t}))\n\n\t\tthis.addEvaluator(new BuffEvaluator({\n\t\t\tactions: [this.data.actions.BATTLE_VOICE,\n\t\t\t\tthis.data.actions.RADIANT_FINALE,\n\t\t\t],\n\t\t\tgcdThreshold: BUFF_BEST_USED_BEFORE_GCD,\n\t\t\tsuggestionContent: <Trans id=\"brd.rs.suggestions.buff-evaluator.content\">\n\t\t\t\tUsing <DataLink action=\"RADIANT_FINALE\" /> and <DataLink action=\"BATTLE_VOICE\" /> within the first two GCDs of <DataLink action=\"RAGING_STRIKES\" /> windows allows you to better align their duration and maximize the multiplicative bonuses these statuses give you.\n\t\t\t</Trans>,\n\t\t\tsuggestionIcon: this.data.actions.RADIANT_FINALE.icon,\n\t\t\tseverityTiers: {\n\t\t\t\t1: SEVERITY.MINOR,\n\t\t\t\t2: SEVERITY.MEDIUM,\n\t\t\t\t3: SEVERITY.MAJOR,\n\t\t\t},\n\t\t}))\n\n\t\tthis.addEvaluator(new ExpectedActionsEvaluator({\n\t\t\texpectedActions: [\n\t\t\t\t{\n\t\t\t\t\taction: this.data.actions.APEX_ARROW,\n\t\t\t\t\texpectedPerWindow: 1,\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\taction: this.data.actions.BLAST_ARROW,\n\t\t\t\t\texpectedPerWindow: 1,\n\t\t\t\t},\n\t\t\t],\n\t\t\tsuggestionIcon: this.data.actions.BLAST_ARROW.icon,\n\t\t\tsuggestionContent: <Trans id=\"brd.rs.suggestions.aaba-evaluator.content\">\n\t\t\t\tOne use of <DataLink action=\"APEX_ARROW\"/> and <DataLink action=\"BLAST_ARROW\"/> should occur during every <DataLink action=\"RAGING_STRIKES\"/> window after the opener. Make sure you have at least 80 Soul Voice Gauge for your buffs.\n\t\t\t</Trans>,\n\t\t\tsuggestionWindowName,\n\t\t\tseverityTiers: {\n\t\t\t\t1: SEVERITY.MEDIUM,\n\t\t\t\t3: SEVERITY.MAJOR,\n\t\t\t},\n\t\t\tadjustCount: this.adjustExpectedApexCount.bind(this),\n\t\t}))\n\n\t\tthis.addEvaluator(new ExpectedActionGroupsEvaluator({\n\t\t\texpectedActionGroups: [{\n\t\t\t\tactions: [this.data.actions.BLOODLETTER, this.data.actions.RAIN_OF_DEATH],\n\t\t\t\texpectedPerWindow: 3,\n\t\t\t}],\n\t\t\tsuggestionIcon: this.data.actions.BLOODLETTER.icon,\n\t\t\tsuggestionContent: <Trans id=\"brd.rs.suggestions.bloodletter-evaluator.content\">\n\t\t\t\tAt least three uses of <DataLink action=\"BLOODLETTER\"/> or <DataLink action=\"RAIN_OF_DEATH\"/> should occur during every <DataLink action=\"RAGING_STRIKES\"/> window. Make sure you pool your <DataLink action=\"BLOODLETTER\"/> or <DataLink action=\"RAIN_OF_DEATH\"/> charges during <DataLink action=\"ARMYS_PAEON\"/>.\n\t\t\t</Trans>,\n\t\t\tsuggestionWindowName,\n\t\t\tseverityTiers: {\n\t\t\t\t1: SEVERITY.MINOR,\n\t\t\t\t3: SEVERITY.MEDIUM,\n\t\t\t\t5: SEVERITY.MAJOR,\n\t\t\t},\n\t\t}))\n\t}\n\n\tprivate get activeMuse(): MuseWindow | undefined {\n\t\tconst last = _.last(this.museHistory)\n\t\tif (last && !isDefined(last.end)) {\n\t\t\treturn last\n\t\t}\n\t\treturn undefined\n\t}\n\n\tprivate onApplyMuse(event: Events['statusApply']) {\n\t\tthis.museHistory.push({start: event.timestamp})\n\t}\n\n\tprivate onRemoveMuse(event: Events['statusRemove']) {\n\t\tif (this.activeMuse) {\n\t\t\tthis.activeMuse.end = event.timestamp\n\t\t}\n\t}\n\n\tprivate onRemoveBarrage(event: Events['statusRemove']) {\n\t\tthis.barrageRemoves.push(event.timestamp)\n\t}\n\n\tprivate adjustExpectedGcdCount(window: HistoryEntry<EvaluatedAction[]>) {\n\t\t// Check if muse was up for at least 3 GCDs in this buffWindow\n\t\tconst museOverlap = this.museHistory.some(muse => (\n\t\t\twindow.data.filter(event => this.data.getAction(event.action.id)?.onGcd &&\n\t\t\t\tevent.timestamp > muse.start && (!muse.end || event.timestamp < muse.end))\n\t\t\t\t.length >= MIN_MUSE_GCDS\n\t\t))\n\n\t\treturn museOverlap ? 1 : 0\n\t}\n\n\tprivate adjustExpectedActionCount(window: HistoryEntry<EvaluatedAction[]>, action: TrackedAction) {\n\t\t/**\n\t\t * IJ definitely shouldn't be used at the end of the fight, so reduce by 1\n\t\t * Barrage might have floated to the end of the RS window, so reduce by 1\n\t\t */\n\t\tif (this.isRushedEndOfPullWindow(window)) {\n\t\t\treturn -1\n\t\t}\n\n\t\t// If the action was Iron Jaws, the upper limit = the number of enemies we cast something on during this RS window\n\t\tif (action.action !== this.data.actions.IRON_JAWS) {\n\t\t\treturn 0\n\t\t}\n\n\t\tconst enemyIDs = new Set<string>()\n\t\twindow.data\n\t\t\t.filter(e => this.actors.get(e.target).team === Team.FOE)\n\t\t\t.forEach(e => enemyIDs.add(e.target))\n\n\t\t// Baseline number of allowed Iron Jaws is 1 and this function is an adjustment.\n\t\treturn Math.max(enemyIDs.size - 1, 0)\n\t}\n\n\tprivate adjustExpectedActionOutcome(window: HistoryEntry<EvaluatedAction[]>, action: TrackedAction) {\n\t\t/**\n\t\t * Positive only if we had exactly one Iron Jaws in this RS\n\t\t * If expected > 1, we're in AoE and there is no clear rotation target, so don't highlight this cell\n\t\t */\n\t\tif (action.action === this.data.actions.IRON_JAWS) {\n\t\t\treturn (actual: number, expected?: number) => {\n\t\t\t\tif (!isDefined(expected) || expected > 1) {\n\t\t\t\t\treturn RotationTargetOutcome.NEUTRAL\n\t\t\t\t}\n\n\t\t\t\tif (actual === expected) {\n\t\t\t\t\treturn RotationTargetOutcome.POSITIVE\n\t\t\t\t}\n\n\t\t\t\treturn RotationTargetOutcome.NEGATIVE\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate adjustExpectedApexCount(window: HistoryEntry<EvaluatedAction[]>) {\n\t\t// If the action is Apex Arrow or Blast Arrow, shouldn't count at the first window of the fight,\n\t\t// since there's no gauge to be spent\n\t\tif (window.start - APEX_OPENER_BUFFER <= this.parser.pull.timestamp) {\n\t\t\treturn -1\n\t\t}\n\n\t\treturn 0\n\t}\n\n\tprivate wasBarrageUsed(window: HistoryEntry<EvaluatedAction[]>) {\n\t\tconst gcdTimestamps = window.data\n\t\t\t.filter(event => event.action.onGcd)\n\t\t\t.map(event => event.timestamp)\n\t\tif (gcdTimestamps.length === 0) { return false }\n\n\t\t// Check to make sure at least one GCD happened before the status expired\n\t\tconst firstGcd = gcdTimestamps[0]\n\t\treturn this.barrageRemoves.some(timestamp => firstGcd <= timestamp && timestamp <= (window.end ?? window.start))\n\t}\n}\n","import {Trans} from '@lingui/react'\nimport {ActionLink, StatusLink} from 'components/ui/DbLink'\nimport {Procs} from 'parser/core/modules/Procs'\nimport React from 'react'\n\nexport class RefulgentProcs extends Procs {\n\toverride trackedProcs = [\n\t\t{\n\t\t\tprocStatus: this.data.statuses.STRAIGHT_SHOT_READY,\n\t\t\tconsumeActions: [this.data.actions.REFULGENT_ARROW],\n\t\t},\n\t]\n\n\toverride showDroppedProcSuggestion = true\n\toverride droppedProcIcon = this.data.actions.REFULGENT_ARROW.icon\n\toverride droppedProcContent = <Trans id=\"brd.procs.suggestions.missed.content\">\n\t\tTry to use <ActionLink {...this.data.actions.REFULGENT_ARROW} /> whenever you have <StatusLink {...this.data.statuses.STRAIGHT_SHOT_READY} />.\n\t</Trans>\n\n\toverride showOverwroteProcSuggestion = true\n\toverride overwroteProcIcon = this.data.actions.REFULGENT_ARROW.icon\n\toverride overwroteProcContent = <Trans id=\"brd.procs.suggestions.overwritten.content\">\n\t\tAvoid using actions that grant <StatusLink {...this.data.statuses.STRAIGHT_SHOT_READY} /> when you\n\t\tcould use <ActionLink {...this.data.actions.REFULGENT_ARROW} /> instead.\n\t</Trans>\n}\n","import {ActionTimeline} from './ActionTimeline'\nimport {AlwaysBeCasting} from './AlwaysBeCasting'\nimport {DoTs} from './DoTs'\nimport {DriftingEa} from './DriftingEa'\nimport {Mitigation} from './Mitigation'\nimport {MultiHitSkills} from './MultiHitSkills'\nimport {OGCDDowntime} from './OGCDDowntime'\nimport {RagingStrikes} from './RagingStrikes'\nimport {RefulgentProcs} from './RefulgentProcs'\n\nexport default [\n\tActionTimeline,\n\tAlwaysBeCasting,\n\tDoTs,\n\tDriftingEa,\n\tMultiHitSkills,\n\tMitigation,\n\tOGCDDowntime,\n\tRagingStrikes,\n\tRefulgentProcs,\n]\n"],"names":["ItemDepth","ActionTimeline","CastTime","Cooldowns","Data","Timeline","resolvedRows","groupRows","action","this","addRow","content","constructor","rows","config","resolvedConfig","resolveConfig","push","addEventHook","onComplete","populatedGroups","row","populateRow","forEach","specifier","cooldowns","groups","group","add","allGroups","has","finalConfig","Array","isArray","ensureArray","existingRow","get","isDefined","firstContent","label","Trans","id","data","actions","name","cooldownHistory","timeline","ContainerRow","order","collapse","set","addCooldownItems","addChargeItems","chargeHistory","history","entry","duration","getCooldownDuration","start","parser","pull","timestamp","end","addItem","SimpleItem","className","item","delta","ActionItem","depth","ACTION","ChargeGainItem","CHARGE_GAIN","endReason","CooldownEndReason","castTime","forAction","Math","max","Analyser","handle","debug","dependency","Content","styles","Icon","BaseItem","AlwaysBeCasting","Checklist","Downtime","GlobalCooldown","SpeedAdjustments","gcdUptime","gcdsCounted","lastBeginCast","filter","source","actor","type","onBeginCast","onCast","event","getAction","onGcd","forEvent","globalCooldown","getDuration","ANIMATION_LOCK","recastTime","recastForEvent","castStart","considerCast","relativeTimestamp","formatEpochTimestamp","undefined","_action","downtime","isDowntime","fightDuration","currentDuration","getDowntime","uptime","checklist","Rule","description","displayOrder","requirements","Requirement","percent","getUptimePercent","target","speedAdjustments","DoTs","Actors","Invulnerability","Statuses","trackedStatuses","statusApplications","status","oneOf","onApply","getStatus","trackedStatus","trackedStatusOnTarget","lastApplied","totalClipping","excludeApplication","clip","addChecklistRules","addClippingSuggestions","statusId","statuses","getUptime","actors","foes","invulnerability","types","round","estimateHelp","__all","legacyFflogs","Statistics","getAdjustedDuration","BASE_GCD","isAdjustmentEstimated","estimated","isEstimated","statistics","SimpleStatistic","title","icon","ATTACK","value","formatDuration","info","report","meta","ft","statusSpecifier","targetSpecifier","targets","edges","edgesForActor","statusHistory","a","b","application","edge","side","events","apply","refresh","splitRangeForInvulns","statusDuration","remove","currentEpochTimestamp","min","range","finalRanges","invulns","getWindows","actorFilter","kind","invuln","previousRange","CoreActionTimeline","armyHistory","currentArmy","armyFilter","ARMYS_MUSE","ARMYS_PAEON","onApplyArmy","onRemoveArmy","armyDuration","acc","army","CoreAlwaysBeCasting","SEVERITIES","CLIPPING","SEVERITY","UPTIME","TARGET","Suggestions","CAUSTIC_BITE","STORMBITE","TieredRule","IRON_JAWS","tiers","meanClip","getClippingAmount","suggestions","TieredSuggestion","why","CoreDoTs","DriftingEa","driftedWindows","currentWindow","eaId","EMPYREAL_ARROW","castFilter","onDriftableCast","cooldown","window","observedUseTime","earliestUseTime","expectedUseTime","downtimeWindow","getDowntimeWindows","drift","driftedActionId","length","driftTable","Table","collapsing","unstackable","compact","Button","onClick","show","Fragment","Message","sheet","Mitigation","trackedDefensives","NATURES_MINNE","TROUBADOUR","Defensives","MultiHitSkills","suggestionIcon","ACTIONS","trackedActions","aoeAction","stActions","minTargets","AoEUsages","displayerOrder","OGCDDowntime","trackedCds","firstUseOffset","allowedAverageDowntime","BATTLE_VOICE","RADIANT_FINALE","RAGING_STRIKES","BARRAGE","SIDEWINDER","CooldownDowntime","SUPPORT_ACTIONS","BarrageEvaluator","opts","barrageId","wasBarrageUsed","ExpectedActionsEvaluator","BuffEvaluator","opt","gcdThreshold","suggestionContent","suggestionWhy","severityTiers","wasActionUsedInTime","actionId","buffAction","it","gcdThresholdAction","windows","format","header","showName","accessor","generateNotes","usedInTime","wrongUsages","Number","RagingStrikes","buffStatus","museHistory","barrageRemoves","ignoreActions","actionKey","playerFilter","buffFilter","onApplyMuse","onRemoveMuse","onRemoveBarrage","suggestionWindowName","showIcon","addEvaluator","ExpectedGcdCountEvaluator","expectedGcds","hasStacks","adjustCount","adjustExpectedGcdCount","bind","expectedActions","expectedPerWindow","adjustExpectedActionCount","adjustOutcome","adjustExpectedActionOutcome","APEX_ARROW","BLAST_ARROW","adjustExpectedApexCount","ExpectedActionGroupsEvaluator","expectedActionGroups","BLOODLETTER","RAIN_OF_DEATH","last","activeMuse","some","muse","isRushedEndOfPullWindow","enemyIDs","e","team","Team","size","actual","expected","RotationTargetOutcome","gcdTimestamps","firstGcd","BuffWindow","RefulgentProcs","trackedProcs","procStatus","STRAIGHT_SHOT_READY","consumeActions","REFULGENT_ARROW","showDroppedProcSuggestion","droppedProcIcon","droppedProcContent","showOverwroteProcSuggestion","overwroteProcIcon","overwroteProcContent","Procs"],"sourceRoot":""}