(self.webpackChunk_xivanalysis_client=self.webpackChunk_xivanalysis_client||[]).push([[9364],{46423:function(t,e,i){t.exports=i(34913)},50281:function(t,e,i){"use strict";i.d(e,{e:function(){return U}});var a,n,s,o,r,l,u,c,d,h,f,p,v,g,m,y=i(23257),w=i(68420),b=i(27344),E=i(5281),I=i(90306),T=i(50596),A=i(300),R=i(77766),Z=i.n(R),_=i(86359),C=i(84626),k=i(28683),O=i(74489),D=i(76704),H=i(8510),N=i(52102),S=i(73947),x=i(51691),L=i(83459),P=i(48453),F=(i(67294),i(85893)),U=(a=Reflect.metadata("design:type",H.Z),n=Reflect.metadata("design:type",N.ZP),s=Reflect.metadata("design:type",S.V),o=Reflect.metadata("design:type",x.Z),r=Reflect.metadata("design:type",L.E),l=Reflect.metadata("design:type",P.a),m=g=function(t){(0,I.Z)(i,t);var e=(0,T.Z)(i);function i(){var t,a;(0,w.Z)(this,i);for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return a=e.call.apply(e,Z()(t=[this]).call(t,s)),(0,y.Z)(a,"castTime",c,(0,E.Z)(a)),(0,y.Z)(a,"checklist",d,(0,E.Z)(a)),(0,y.Z)(a,"data",h,(0,E.Z)(a)),(0,y.Z)(a,"downtime",f,(0,E.Z)(a)),(0,y.Z)(a,"globalCooldown",p,(0,E.Z)(a)),(0,y.Z)(a,"speedAdjustments",v,(0,E.Z)(a)),a.gcdUptime=0,a.gcdsCounted=0,a.lastBeginCast=void 0,a}return(0,b.Z)(i,[{key:"initialise",value:function(){this.addEventHook((0,O.hX)().source(this.parser.actor.id).type("prepare"),this.onBeginCast),this.addEventHook((0,O.hX)().source(this.parser.actor.id).type("action"),this.onCast),this.addEventHook("complete",this.onComplete)}},{key:"onBeginCast",value:function(t){this.lastBeginCast=t}},{key:"onCast",value:function(t){var e,i,a=this.data.getAction(t.action);if(null!=a&&null!=a.onGcd&&a.onGcd){var n=null!==(e=this.castTime.forEvent(t))&&void 0!==e?e:0;n>=this.globalCooldown.getDuration()&&(n+=C.C);var s=null!==(i=this.castTime.recastForEvent(t))&&void 0!==i?i:0,o=null!=this.lastBeginCast&&this.lastBeginCast.action===t.action?this.lastBeginCast.timestamp:t.timestamp;if(this.considerCast(a,o)){var r,l,u,c,d,h,f,p=t.timestamp-this.parser.pull.timestamp;n>p?(this.debug(Z()(r=Z()(l=Z()(u=Z()(c="GCD Uptime for precast ".concat(a.name," at ")).call(c,this.parser.formatEpochTimestamp(t.timestamp,1)," - Cast time: ")).call(u,n," | Recast time: ")).call(l,s," | Time of completion: ")).call(r,p)),this.gcdUptime+=Math.max(0,p)):(this.debug(Z()(d=Z()(h=Z()(f="GCD Uptime for ".concat(a.name," at ")).call(f,this.parser.formatEpochTimestamp(t.timestamp,1)," - Cast time: ")).call(h,n," | Recast time: ")).call(d,s)),this.gcdUptime+=Math.max(n,s)),this.gcdsCounted+=1}else{var v;this.debug(Z()(v="Excluding cast of ".concat(a.name," at ")).call(v,this.parser.formatEpochTimestamp(t.timestamp,1)))}this.lastBeginCast=void 0}}},{key:"considerCast",value:function(t,e){return!this.downtime.isDowntime(e)}},{key:"getUptimePercent",value:function(){var t,e,i;this.debug(Z()(t="Observed ".concat(this.gcdsCounted," GCDs for a total of ")).call(t,this.gcdUptime," ms of uptime"));var a=this.parser.currentDuration-this.downtime.getDowntime(),n=this.gcdUptime/a*100;return this.debug(Z()(e=Z()(i="Total fight duration: ".concat(this.parser.currentDuration," - Downtime: ")).call(i,this.downtime.getDowntime()," - Uptime percentage ")).call(e,n)),n}},{key:"onComplete",value:function(){0!==this.gcdUptime&&this.checklist.add(new N.$9({name:(0,F.jsx)(_.Trans,{id:"core.always-cast.title",defaults:"Always be casting"}),description:(0,F.jsx)(_.Trans,{id:"core.always-cast.description",defaults:"Make sure you're always doing something. It's often better to make small mistakes while keeping the GCD rolling than it is to perform the correct rotation slowly."}),displayOrder:-1,requirements:[new N.nb({name:(0,F.jsx)(_.Trans,{id:"core.always-cast.gcd-uptime",defaults:"GCD Uptime"}),percent:this.getUptimePercent()})],target:98}))}}]),i}(k.qk),g.handle="abc",g.debug=!1,u=m,c=(0,A.Z)(u.prototype,"castTime",[D.I,a],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return this.castTime}}),d=(0,A.Z)(u.prototype,"checklist",[D.I,n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return this.checklist}}),h=(0,A.Z)(u.prototype,"data",[D.I,s],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return this.data}}),f=(0,A.Z)(u.prototype,"downtime",[D.I,o],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return this.downtime}}),p=(0,A.Z)(u.prototype,"globalCooldown",[D.I,r],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return this.globalCooldown}}),v=(0,A.Z)(u.prototype,"speedAdjustments",[D.I,l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return this.speedAdjustments}}),u)},44971:function(t,e,i){"use strict";i.d(e,{h:function(){return N}});var a,n,s,o,r,l,u,c,d,h=i(8333),f=i(99021),p=i(23257),v=i(68420),g=i(27344),m=i(5281),y=i(90306),w=i(50596),b=i(300),E=i(77766),I=i.n(E),T=i(39392),A=i.n(T),R=i(86359),Z=(i(67294),i(28683)),_=i(74489),C=i(76704),k=i(73947),O=i(52250),D=i(56611),H=i(85893),N=(a=Reflect.metadata("design:type",k.V),n=Reflect.metadata("design:type",O.ZP),s=Reflect.metadata("design:type",D.TY),d=c=function(t){(0,y.Z)(i,t);var e=(0,w.Z)(i);function i(){var t,a;(0,v.Z)(this,i);for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return a=e.call.apply(e,I()(t=[this]).call(t,s)),(0,p.Z)(a,"data",r,(0,m.Z)(a)),(0,p.Z)(a,"suggestions",l,(0,m.Z)(a)),(0,p.Z)(a,"timeline",u,(0,m.Z)(a)),a.info=new(A()),a}return(0,g.Z)(i,[{key:"deadTime",get:function(){return this.getDuration(this.parser.actor.id)}},{key:"getCount",value:function(t){return this.getActorInfo(t).count}},{key:"getDuration",value:function(t){var e,i=this.getActorInfo(t),a=this.parser.currentEpochTimestamp,n=a-(null!==(e=i.timestampDeath)&&void 0!==e?e:a);return i.duration+n}},{key:"initialise",value:function(){this.addEventHook({type:"actorUpdate",hp:{current:0}},this.onDeath),this.addEventHook({type:"statusApply",status:this.data.statuses.TRANSCENDENT.id},this.onTranscendentApply),this.addEventHook({type:"statusRemove",status:this.data.statuses.TRANSCENDENT.id},this.onTranscendentRemove),this.addEventHook("complete",this.onComplete)}},{key:"getActorInfo",value:function(t){var e=this.info.get(t);return null==e&&(e={count:0,duration:0},this.info.set(t,e)),e}},{key:"onDeath",value:function(t){var e=this,i=this.getActorInfo(t.actor);if(null==i.timestampDeath&&null==i.timestampTranscendent){var a=this.shouldCountDeath(t);this.parser.queueEvent({type:"death",timestamp:t.timestamp,actor:t.actor,counted:a}),a&&(i.timestampDeath=t.timestamp,i.count++,i.raiseHook=this.addEventHook((0,_.hX)().type("actorUpdate").actor(t.actor).hp((0,_.hX)().current((function(t){return t>0}))),(function(t){return e.onRaise(t.actor,t.timestamp)})))}}},{key:"shouldCountDeath",value:function(t){return!0}},{key:"onTranscendentApply",value:function(t){this.getActorInfo(t.target).timestampTranscendent=t.timestamp,this.onRaise(t.target,t.timestamp)}},{key:"onTranscendentRemove",value:function(t){this.getActorInfo(t.target).timestampTranscendent=void 0}},{key:"onRaise",value:function(t,e){var i=this.getActorInfo(t);null!=i.timestampDeath&&(t===this.parser.actor.id&&this.addDeathToTimeline(i.timestampDeath,e),i.duration+=e-i.timestampDeath,i.timestampDeath=void 0,null!=i.raiseHook&&(this.removeEventHook(i.raiseHook),i.raiseHook=void 0),this.parser.queueEvent({type:"raise",timestamp:e,actor:t}))}},{key:"onComplete",value:function(t){var e,i=(0,f.Z)(this.info);try{for(i.s();!(e=i.n()).done;){var a,n=(0,h.Z)(e.value,2),s=n[0],o=n[1];(null!==(a=this.parser.pull.progress)&&void 0!==a?a:0)<100&&null!=o.timestampDeath&&(o.count=Math.max(o.count-1,0)),this.onRaise(s,t.timestamp)}}catch(t){i.e(t)}finally{i.f()}var r=this.getActorInfo(this.parser.actor.id);0!==r.count&&this.suggestions.add(new O.q$({icon:this.data.actions.RAISE.icon,content:(0,H.jsx)(R.Trans,{id:"core.deaths.content",defaults:"Don't die. Between downtime, lost gauge resources, and resurrection debuffs, dying is absolutely <0>crippling</0> to damage output.",components:[(0,H.jsx)("em",{})]}),severity:O.bI.MORBID,why:(0,H.jsx)(R.Trans,{id:"core.deaths.why",defaults:"{0, plural, =1 {# death} other {# deaths}}",values:{0:r.count}})}))}},{key:"addDeathToTimeline",value:function(t,e){this.timeline.addItem(new D.ct({start:t-this.parser.pull.timestamp,end:e-this.parser.pull.timestamp,content:(0,H.jsx)("div",{style:{width:"100%",height:"100%",backgroundColor:"#ce909085"}})}))}}]),i}(Z.qk),c.handle="death",c.debug=!0,o=d,r=(0,b.Z)(o.prototype,"data",[C.I,a],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return this.data}}),l=(0,b.Z)(o.prototype,"suggestions",[C.I,n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return this.suggestions}}),u=(0,b.Z)(o.prototype,"timeline",[C.I,s],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return this.timeline}}),o)},59473:function(t,e,i){"use strict";i.d(e,{e:function(){return k}});var a,n,s,o,r,l,u,c=i(23257),d=i(68420),h=i(27344),f=i(5281),p=i(90306),v=i(50596),g=i(300),m=i(77766),y=i.n(m),w=i(86359),b=i(9263),E=i(28683),I=i(74489),T=i(76704),A=i(73947),R=i(52250),Z=i(67294),_=i(85893),C={USE_PERCENT_THRESHOLD:{.8:R.bI.MAJOR,.4:R.bI.MEDIUM,.2:R.bI.MINOR}},k=(a=Reflect.metadata("design:type",A.V),n=Reflect.metadata("design:type",R.ZP),u=l=function(t){(0,p.Z)(i,t);var e=(0,v.Z)(i);function i(){var t,a;(0,d.Z)(this,i);for(var n=arguments.length,s=new Array(n),l=0;l<n;l++)s[l]=arguments[l];return a=e.call.apply(e,y()(t=[this]).call(t,s)),(0,c.Z)(a,"data",o,(0,f.Z)(a)),(0,c.Z)(a,"suggestions",r,(0,f.Z)(a)),a.lastUse=0,a.uses=0,a.totalHeld=0,a.suggestionContent=(0,_.jsx)(Z.Fragment,{children:(0,_.jsx)(w.Trans,{id:"core.lucid-dreaming.suggestion.content",defaults:"Try to keep <0/> on cooldown for better MP management.",components:[(0,_.jsx)(b.P9,{action:"LUCID_DREAMING"})]})}),a}return(0,h.Z)(i,[{key:"initialise",value:function(){this.addEventHook((0,I.hX)().source(this.parser.actor.id).type("action").action(this.data.actions.LUCID_DREAMING.id),this.onCastLucid),this.addEventHook("complete",this.onComplete)}},{key:"onCastLucid",value:function(t){this.uses++,0===this.lastUse&&(this.lastUse=this.parser.pull.timestamp);var e;(e=1===this.uses?t.timestamp-this.parser.pull.timestamp:t.timestamp-this.lastUse-this.data.actions.LUCID_DREAMING.cooldown)>0&&(this.totalHeld+=e),this.lastUse=t.timestamp}},{key:"suggestionWhy",value:function(t,e){return(0,_.jsx)(Z.Fragment,{children:(0,_.jsx)(w.Trans,{id:"core.lucid-dreaming.suggestion.why",defaults:"{usesMissed, plural, one {# use} other {# uses}} of Lucid Dreaming {usesMissed, plural, one {was} other {were}} missed by holding it for at least a total of {0}.",values:{0:this.parser.formatDuration(e),usesMissed:t}})})}},{key:"onComplete",value:function(){var t=0===this.uses?this.parser.pull.duration:this.totalHeld,e=Math.floor(t/this.data.actions.LUCID_DREAMING.cooldown),i=0===e?0:t/this.parser.pull.duration;this.suggestions.add(new R.eg({icon:this.data.actions.LUCID_DREAMING.icon,content:this.suggestionContent,tiers:C.USE_PERCENT_THRESHOLD,why:this.suggestionWhy(e,t),value:i}))}}]),i}(E.qk),l.handle="lucid",l.dependencies=["suggestions"],s=u,o=(0,g.Z)(s.prototype,"data",[T.I,a],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return this.data}}),r=(0,g.Z)(s.prototype,"suggestions",[T.I,n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return this.suggestions}}),s)},74136:function(t,e,i){"use strict";i.d(e,{z:function(){return M}});var a,n,s,o,r,l,u,c,d,h=i(8333),f=i(99021),p=i(41420),v=i(23257),g=i(68420),m=i(27344),y=i(5281),w=i(90306),b=i(50596),E=i(300),I=i(10928),T=i.n(I),A=i(77766),R=i.n(A),Z=i(39392),_=i.n(Z),C=i(2991),k=i.n(C),O=i(20116),D=i.n(O),H=i(20455),N=i.n(H),S=i(89400),x=i.n(S),L=i(28683),P=i(74489),F=i(76704),U=i(61806),j=i(70273),G=i(73947),B=i(56611),M=(a=Reflect.metadata("design:type",U.E),n=Reflect.metadata("design:type",j.e),s=Reflect.metadata("design:type",G.V),d=c=function(t){(0,w.Z)(i,t);var e=(0,b.Z)(i);function i(){var t,a;(0,g.Z)(this,i);for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return a=e.call.apply(e,R()(t=[this]).call(t,s)),(0,v.Z)(a,"actionTimeline",r,(0,y.Z)(a)),(0,v.Z)(a,"actors",l,(0,y.Z)(a)),(0,v.Z)(a,"data",u,(0,y.Z)(a)),a.statusActionMap=new(_()),a.usages=new(_()),a.rows=new(_()),a.getRowKey=function(t,e){var i;return R()(i="".concat(t,":")).call(i,e)},a}return(0,m.Z)(i,[{key:"initialise",value:function(){var t,e,i,a,n,s=this,o=k()(t=D()(e=this.parser.pull.actors).call(e,(function(t){return t.owner===s.parser.actor}))).call(t,(function(t){return t.id})),r=k()(i=D()(a=this.parser.pull.actors).call(a,(function(t){var e;return!0===(null===(e=t.owner)||void 0===e?void 0:e.playerControlled)}))).call(i,(function(t){return t.id})),l=(0,P.hX)().source((0,P.kw)(R()(n=[this.parser.actor.id]).call(n,(0,p.Z)(o)))).target((0,P.jg)(r));this.addEventHook(l.type("statusApply"),this.onApply),this.addEventHook(l.type("statusRemove"),this.onRemove),this.addEventHook("complete",this.onComplete);for(var u=0,c=N()(this.data.actions);u<c.length;u++){var d=c[u];if(null!=d.statusesApplied){var h,v=(0,f.Z)(d.statusesApplied);try{for(v.s();!(h=v.n()).done;){var g=h.value,m=this.data.statuses[g].id;this.statusActionMap.set(m,d)}}catch(t){v.e(t)}finally{v.f()}}}}},{key:"onApply",value:function(t){var e=this.usages.get(t.status);null==e&&(e=new(_()),this.usages.set(t.status,e));var i=e.get(t.target);if(null==i){var a=this.createStatusTargetRow(t.status,t.target);if(null==a)return;i={usages:[],row:a},e.set(t.target,i)}var n=T()(i.usages);null!=n&&null==n.end||i.usages.push({start:t.timestamp})}},{key:"onRemove",value:function(t){var e,i,a=T()(null===(e=this.usages.get(t.status))||void 0===e||null===(i=e.get(t.target))||void 0===i?void 0:i.usages);null!=a&&(a.end=t.timestamp)}},{key:"onComplete",value:function(){var t,e=(0,f.Z)(this.usages);try{for(e.s();!(t=e.n()).done;){var i=(0,h.Z)(t.value,2),a=i[0],n=i[1],s=this.data.getStatus(a);if(null!=s){var o,r=(0,f.Z)(x()(n).call(n));try{for(r.s();!(o=r.n()).done;){var l,u=o.value,c=(0,f.Z)(u.usages);try{for(c.s();!(l=c.n()).done;){var d,p=l.value;u.row.addItem(new B.hg({status:s,start:p.start-this.parser.pull.timestamp,end:(null!==(d=p.end)&&void 0!==d?d:this.parser.pull.timestamp+this.parser.pull.duration)-this.parser.pull.timestamp}))}}catch(t){c.e(t)}finally{c.f()}}}catch(t){r.e(t)}finally{r.f()}}}}catch(t){e.e(t)}finally{e.f()}}},{key:"createStatusTargetRow",value:function(t,e){var i,a=null!==(i=this.constructor.statusesStackMapping[t])&&void 0!==i?i:t,n=this.getRowKey(a,e),s=this.rows.get(n);if(null!=s)return s;var o=this.createStatusRow(a);if(null!=o){var r=this.actors.get(e),l=o.addRow(new B.e2({label:r.name}));return this.rows.set(n,l),l}}},{key:"createStatusRow",value:function(t){var e,i,a=this.getRowKey(t),n=this.rows.get(a);if(null!=n)return n;var s=this.statusActionMap.get(t);if(null!=s){var o=this.actionTimeline.getRow(s).addRow(new B.e2({label:null!==(e=null===(i=this.data.getStatus(t))||void 0===i?void 0:i.name)&&void 0!==e?e:t,hideCollapsed:!0,collapse:!0}));return this.rows.set(a,o),o}}}]),i}(L.qk),c.handle="statusTimeline",c.statusesStackMapping={},o=d,r=(0,E.Z)(o.prototype,"actionTimeline",[F.I,a],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return this.actionTimeline}}),l=(0,E.Z)(o.prototype,"actors",[F.I,n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return this.actors}}),u=(0,E.Z)(o.prototype,"data",[F.I,s],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return this.data}}),o)},45715:function(t,e,i){"use strict";i.d(e,{x:function(){return z}});var a,n,s,o,r,l,u,c,d,h,f,p=i(41420),v=i(97530),g=i(23257),m=i(68420),y=i(27344),w=i(5281),b=i(90306),E=i(50596),I=i(300),T=i(77766),A=i.n(T),R=i(20116),Z=i.n(R),_=i(2991),C=i.n(_),k=i(86359),O=i(40090),D=i(71370),H=i(84626),N=i(28683),S=i(74489),x=i(76704),L=i(8510),P=i(73947),F=i(90577),U=i(52250),j=(i(67294),i(30919)),G=i(40753),B=i(85893),M={0:2,1e3:1,2500:0},W={1:U.bI.MEDIUM,5:U.bI.MAJOR},z=(a=Reflect.metadata("design:type",L.Z),n=Reflect.metadata("design:type",P.V),s=Reflect.metadata("design:type",F.I),o=Reflect.metadata("design:type",U.ZP),f=h=function(t){(0,b.Z)(i,t);var e=(0,E.Z)(i);function i(){var t,a;(0,m.Z)(this,i);for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return a=e.call.apply(e,A()(t=[this]).call(t,s)),(0,g.Z)(a,"castTime",l,(0,w.Z)(a)),(0,g.Z)(a,"data",u,(0,w.Z)(a)),(0,g.Z)(a,"invulnerability",c,(0,w.Z)(a)),(0,g.Z)(a,"suggestions",d,(0,w.Z)(a)),a.suggestionIcon="https://xivapi.com/i/001000/001785.png",a.moduleLink=(0,B.jsx)("a",{style:{cursor:"pointer"},onClick:function(){return a.parser.scrollTo(i.handle)},children:(0,B.jsx)(O.Z,{message:i.title})}),a.suggestionContent=(0,B.jsx)(k.Trans,{id:"core.weaving.content",defaults:"Avoid weaving more actions than you have time for in a single GCD window. Doing so will delay your next GCD, reducing possible uptime. Check the {0} module below for more detailed analysis.",values:{0:a.moduleLink}}),a.severity=W,a.weaves=[],a.ongoingCastEvent=void 0,a.leadingGcdEvent=void 0,a.trailingGcdEvent=void 0,a.badWeaves=[],a}return(0,y.Z)(i,[{key:"initialise",value:function(){var t=(0,S.hX)().source(this.parser.actor.id);this.addEventHook(t.type("prepare"),this.onBeginCast),this.addEventHook(t.type("action"),this.onCast),this.addEventHook((0,S.hX)().type("complete"),this.onComplete),this.addEventHook((0,S.hX)().type("death"),this.clearWeave)}},{key:"onBeginCast",value:function(t){this.ongoingCastEvent=t}},{key:"onCast",value:function(t){var e=this.data.getAction(t.action);e&&!e.autoAttack&&(this.isOgcd(e)?this.weaves.push(t):(this.ongoingCastEvent&&this.ongoingCastEvent.action===e.id?this.trailingGcdEvent=(0,v.Z)((0,v.Z)({},t),{},{timestamp:this.ongoingCastEvent.timestamp}):this.trailingGcdEvent=t,this.ongoingCastEvent=void 0,this.saveIfBad(),this.leadingGcdEvent=this.trailingGcdEvent,this.weaves=[]))}},{key:"onComplete",value:function(){this.leadingGcdEvent&&this.saveIfBad(),this.suggestions.add(new U.eg({icon:this.suggestionIcon,content:this.suggestionContent,why:(0,B.jsx)(k.Trans,{id:"core.weaving.why",defaults:"{0, plural, =1 {# instance of incorrect weaving} other {# instances of incorrect weaving}}",values:{0:this.badWeaves.length}}),tiers:this.severity,value:this.badWeaves.length}))}},{key:"saveIfBad",value:function(){var t,e;if(null!=this.trailingGcdEvent){var i=null!==(t=null===(e=this.leadingGcdEvent)||void 0===e?void 0:e.timestamp)&&void 0!==t?t:this.parser.pull.timestamp,a=this.trailingGcdEvent.timestamp-i-this.invulnerability.getDuration({start:i,end:this.trailingGcdEvent.timestamp}),n={leadingGcdEvent:this.leadingGcdEvent,trailingGcdEvent:this.trailingGcdEvent,gcdTimeDiff:a,weaves:this.weaves};0!==n.weaves.length&&this.isBadWeave(n)&&this.badWeaves.push(n)}}},{key:"isOgcd",value:function(t){return!t.onGcd&&!t.autoAttack}},{key:"isBadWeave",value:function(t){var e,i,a=this,n=Z()(e=t.weaves).call(e,(function(t){return!a.invulnerability.isActive({timestamp:t.timestamp,types:["untargetable"]})&&t.timestamp>=a.parser.pull.timestamp})).length,s=null!==(i=null!=t.leadingGcdEvent?this.castTime.recastForEvent(t.leadingGcdEvent):void 0)&&void 0!==i?i:H.b;return t.gcdTimeDiff>s&&n>this.getMaxWeaves(t)}},{key:"clearWeave",value:function(){this.weaves.length>0&&this.saveIfBad(),this.weaves=[],this.leadingGcdEvent=void 0}},{key:"getMaxWeaves",value:function(t){var e,i;if(null==t.leadingGcdEvent)return 2;var a=this.castTime.forEvent(t.leadingGcdEvent);return null==a?2:(null!==(e=(0,G.CL)(M,a))&&void 0!==e?e:2)-((null!==(i=this.castTime.recastForEvent(t.leadingGcdEvent))&&void 0!==i?i:H.b)<1800?1:0)}},{key:"output",value:function(){var t,e=this;if(0===this.badWeaves.length)return!1;var i=C()(t=this.badWeaves).call(t,(function(t){var i,a,n,s,o;return{key:null!==(i=null===(a=t.leadingGcdEvent)||void 0===a?void 0:a.timestamp)&&void 0!==i?i:e.parser.pull.timestamp,title:{content:(0,B.jsxs)(B.Fragment,{children:[(0,B.jsx)("strong",{children:e.parser.formatEpochTimestamp(null!==(n=null===(s=t.leadingGcdEvent)||void 0===s?void 0:s.timestamp)&&void 0!==n?n:e.parser.pull.timestamp)})," - ",(0,B.jsx)(k.Trans,{id:"core.weaving.panel-count",defaults:"{0, plural, =1 {# weave} other {# weaves}}",values:{0:t.weaves.length}})," (",e.parser.formatDuration(t.gcdTimeDiff)," ",(0,B.jsx)(k.Trans,{id:"core.weaving.between-gcds",defaults:"between GCDs"}),")"]})},content:{content:(0,B.jsx)(D.Z,{events:A()(o=[]).call(o,(0,p.Z)(null!=t.leadingGcdEvent?[t.leadingGcdEvent]:[]),(0,p.Z)(t.weaves))})}}}));return(0,B.jsx)(j.Z,{exclusive:!1,panels:i,styled:!0,fluid:!0})}}]),i}(N.qk),h.handle="weaving",h.title={id:"core.weaving.title",defaults:"Weaving Issues"},r=f,l=(0,I.Z)(r.prototype,"castTime",[x.I,a],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return this.castTime}}),u=(0,I.Z)(r.prototype,"data",[x.I,n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return this.data}}),c=(0,I.Z)(r.prototype,"invulnerability",[x.I,s],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return this.invulnerability}}),d=(0,I.Z)(r.prototype,"suggestions",[x.I,o],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return this.suggestions}}),r)},1440:function(t,e,i){"use strict";i.r(e),i.d(e,{default:function(){return ui}});var a,n=i(59473),s=i(90137),o=i(41420),r=i(68420),l=i(90306),u=i(50596),c=i(77766),d=i.n(c),h=i(61806),f=function(t){(0,l.Z)(i,t);var e=(0,u.Z)(i);function i(){return(0,r.Z)(this,i),e.apply(this,arguments)}return i}(h.E);f.rows=d()(a=[]).call(a,(0,o.Z)(h.E.rows),["NIGHTBLOOM","TRIPLE_TRIDENT","THE_ROSE_OF_DESTRUCTION","SHOCK_STRIKE","BLU_MOUNTAIN_BUSTER","GLASS_DANCE","SURPANAKHA",["MATRA_MAGIC","DRAGON_FORCE","ANGELS_SNACK"],"FEATHER_RAIN","ERUPTION",["PHANTOM_FLURRY","PHANTOM_FLURRY_KICK"],["QUASAR","J_KICK"],{label:"Raid Buffs",content:["PECULIAR_LIGHT","OFF_GUARD"]},"COLD_FOG","LUCID_DREAMING","SWIFTCAST","ADDLE","MAGIC_HAMMER","ANGEL_WHISPER","DEVOUR","CHELONIAN_GATE"]);var p,v,g,m,y,w,b,E,I,T,A,R,Z,_,C,k,O,D,H,N,S,x,L,P,F,U,j,G,B,M,W,z,K,X,Y,V,q,J,Q,$,tt,et,it,at,nt=i(23257),st=i(27344),ot=i(5281),rt=i(18527),lt=i(3362),ut=i(300),ct=i(32366),dt=i.n(ct),ht=i(20116),ft=i.n(ht),pt=i(86359),vt=i(9263),gt=i(74489),mt=i(76704),yt=i(70273),wt=i(50281),bt=i(52250),Et=i(67294),It=i(85893),Tt=(p=Reflect.metadata("design:type",bt.ZP),v=Reflect.metadata("design:type",yt.e),g=function(t){(0,l.Z)(i,t);var e=(0,u.Z)(i);function i(){var t,a;(0,r.Z)(this,i);for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return(a=e.call.apply(e,d()(t=[this]).call(t,s))).phantomFlurryHistory=[],a.currentPhantomFlurry=void 0,a.phantomFlurryInterruptingActionHook=void 0,a.surpanakhas=0,(0,nt.Z)(a,"suggestions",m,(0,ot.Z)(a)),(0,nt.Z)(a,"actors",y,(0,ot.Z)(a)),a}return(0,st.Z)(i,[{key:"initialise",value:function(){(0,rt.Z)((0,lt.Z)(i.prototype),"initialise",this).call(this);var t=(0,gt.hX)().source(this.parser.actor.id),e=t.action(this.data.actions.PHANTOM_FLURRY.id).type("action"),a=t.status(this.data.statuses.PHANTOM_FLURRY.id).type("statusRemove"),n=t.action(this.data.actions.PHANTOM_FLURRY_KICK.id).type("action"),s=t.action(this.data.actions.SURPANAKHA.id).type("action");this.addEventHook(e,this.onApplyPhantomFlurry),this.addEventHook(a,this.onRemovePhantomFlurry),this.addEventHook(n,this.onPhantomFlurryFinalKick),this.addEventHook(s,this.onCastSurpanakha)}},{key:"onCastSurpanakha",value:function(){this.surpanakhas++}},{key:"onPhantomFlurryFinalKick",value:function(){var t,e=null!==(t=this.currentPhantomFlurry)&&void 0!==t?t:this.phantomFlurryHistory[this.phantomFlurryHistory.length-1];null!==e&&(e.manualKick=!0)}},{key:"onApplyPhantomFlurry",value:function(t){if(null==this.currentPhantomFlurry){this.currentPhantomFlurry={start:t.timestamp,end:t.timestamp+this.data.statuses.PHANTOM_FLURRY.duration,manualKick:!1,inMoonFlute:this.actors.current.hasStatus(this.data.statuses.WAXING_NOCTURNE.id)};var e=(0,gt.hX)().source(this.parser.actor.id).action((0,gt.jg)([this.data.actions.PHANTOM_FLURRY.id])).type("action");this.phantomFlurryInterruptingActionHook=this.addEventHook(e,this.onRemovePhantomFlurry),this.phantomFlurryHistory.push(this.currentPhantomFlurry)}}},{key:"onRemovePhantomFlurry",value:function(t){null!=this.currentPhantomFlurry&&null!=this.phantomFlurryInterruptingActionHook&&(this.currentPhantomFlurry.end=t.timestamp,this.removeEventHook(this.phantomFlurryInterruptingActionHook),this.currentPhantomFlurry=void 0,this.phantomFlurryInterruptingActionHook=void 0)}},{key:"considerCast",value:function(t,e){return t===this.data.actions.PHANTOM_FLURRY?(this.debug("Phantom Flurry began channeling at ".concat(this.parser.formatEpochTimestamp(e))),!1):(0,rt.Z)((0,lt.Z)(i.prototype),"considerCast",this).call(this,t,e)}},{key:"getUptimePercent",value:function(){var t,e=this,i=this.parser.currentDuration-this.downtime.getDowntime(),a=dt()(t=this.phantomFlurryHistory).call(t,(function(t,i){var a=e.downtime.getDowntime(i.start,i.end);return t+Math.max(i.end-i.start,e.globalCooldown.getDuration())-a}),0),n=1e3*this.surpanakhas;return(this.gcdUptime+a+n)/i*100}},{key:"onComplete",value:function(){var t,e;(0,rt.Z)((0,lt.Z)(i.prototype),"onComplete",this).call(this);var a=dt()(t=this.phantomFlurryHistory).call(t,(function(t,e){var i=e.end-e.start,a=(e.manualKick?4e3:5e3)-i;return a<=0?t:t+Math.ceil(a/1e3)}),0);this.suggestions.add(new bt.eg({icon:this.data.actions.PHANTOM_FLURRY.icon,content:(0,It.jsx)(pt.Trans,{id:"blu.phantom_flurry.dropped_ticks.content",defaults:"Dropping out of <0/> too early will lose damage ticks.  If you are in a <1/> window you want to wait out the entire channel; if you are using it outside of a window and activating the final kick, wait until the last second the <2/> effect is active.",components:[(0,It.jsx)(vt.P9,{action:"PHANTOM_FLURRY"}),(0,It.jsx)(vt.P9,{action:"MOON_FLUTE"}),(0,It.jsx)(vt.P9,{status:"PHANTOM_FLURRY"})]}),why:(0,It.jsx)(pt.Trans,{id:"blu.phantom_flurry.dropped_ticks.why",defaults:"{0, plural, one {# Phantom Flurry tick was} other {# Phantom Flurry ticks were}} dropped due to cancelling the channel too early.",values:{0:null!=a?a:0}}),tiers:{1:bt.bI.MINOR,2:bt.bI.MEDIUM,3:bt.bI.MAJOR},value:a}));var n=ft()(e=this.phantomFlurryHistory).call(e,(function(t){return!t.inMoonFlute&&!t.manualKick})).length;this.suggestions.add(new bt.eg({icon:this.data.actions.PHANTOM_FLURRY_KICK.icon,content:(0,It.jsx)(pt.Trans,{id:"blu.phantom_flurry.dropped_kicks.content",defaults:"While the channel from <0/> is active, it becomes <1/>, a 600 potency button.  If you are using <2/> outside of a <3/> window, then you should use the 600 potency button before the channel runs out.  Use this even if it means dropping the last tick of the channel.",components:[(0,It.jsx)(vt.P9,{action:"PHANTOM_FLURRY"}),(0,It.jsx)(vt.P9,{action:"PHANTOM_FLURRY_KICK"}),(0,It.jsx)(vt.P9,{action:"PHANTOM_FLURRY"}),(0,It.jsx)(vt.P9,{action:"MOON_FLUTE",showIcon:!1})]}),why:(0,It.jsx)(pt.Trans,{id:"blu.phantom_flurry.dropped_kicks.why",defaults:"{0, plural, one {# Phantom Flurry big kick was} other {# Phantom Flurry big kicks were}} dropped by not pressing the button again before the effect ran out.",values:{0:null!=n?n:0}}),tiers:{1:bt.bI.MEDIUM,2:bt.bI.MAJOR},value:n}))}}]),i}(wt.e),m=(0,ut.Z)(g.prototype,"suggestions",[mt.I,p],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return this.suggestions}}),y=(0,ut.Z)(g.prototype,"actors",[mt.I,v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return this.actors}}),g),At=i(97530),Rt=i(2991),Zt=i.n(Rt),_t=i(86902),Ct=i.n(_t),kt=i(20455),Ot=i.n(kt),Dt=i(72119),Ht=i.n(Dt),Nt=i(47302),St=i.n(Nt),xt=i(46423),Lt=i.n(xt),Pt=i(52098),Ft=i(28683),Ut=i(19914),jt=i(73947),Gt=i(56611),Bt=i(40822),Mt=i(68156),Wt=i(65927),zt=i(80967),Kt=(w=Reflect.metadata("design:type",yt.e),b=Reflect.metadata("design:type",jt.V),E=Reflect.metadata("design:type",bt.ZP),I=Reflect.metadata("design:type",Gt.TY),k=C=function(t){(0,l.Z)(i,t);var e=(0,u.Z)(i);function i(){var t,a;(0,r.Z)(this,i);for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return a=e.call.apply(e,d()(t=[this]).call(t,s)),(0,nt.Z)(a,"actors",A,(0,ot.Z)(a)),(0,nt.Z)(a,"data",R,(0,ot.Z)(a)),(0,nt.Z)(a,"suggestions",Z,(0,ot.Z)(a)),(0,nt.Z)(a,"timeline",_,(0,ot.Z)(a)),a.inOffGuard=!1,a.inPeculiarLight=!1,a.inLibra=!1,a.buffHistory={},a.buffActionHook=void 0,a.PECULIAR_LIGHT_ID=a.data.statuses.PECULIAR_LIGHT.id,a.OFF_GUARD_ID=a.data.statuses.OFF_GUARD.id,a.CONDENSED_LIBRA_ASTRAL_ID=a.data.statuses.CONDENSED_LIBRA_ASTRAL.id,a.CONDENSED_LIBRA_UMBRAL_ID=a.data.statuses.CONDENSED_LIBRA_UMBRAL.id,a.CONDENSED_LIBRA_PHYSICAL_ID=a.data.statuses.CONDENSED_LIBRA_PHYSICAL.id,a.previousApply=void 0,a.previousRemove=void 0,a}return(0,st.Z)(i,[{key:"newBuffHistory",value:function(t,e){return new Ut.A((function(){return{buffAction:t,isBuffedAction:e,buffId:0,events:[],overwritten:!1,ours:!1}}))}},{key:"initialise",value:function(){var t,e=this;(0,rt.Z)((0,lt.Z)(i.prototype),"initialise",this).call(this),this.buffHistory[this.data.statuses.OFF_GUARD.id]=this.newBuffHistory(this.data.actions.OFF_GUARD,(function(){return!0})),this.buffHistory[this.data.statuses.PECULIAR_LIGHT.id]=this.newBuffHistory(this.data.actions.PECULIAR_LIGHT,(function(t){return t.damageType===Pt.BN.MAGICAL}));var a=this.CONDENSED_LIBRA_ASTRAL_ID,n=this.CONDENSED_LIBRA_UMBRAL_ID,s=this.CONDENSED_LIBRA_PHYSICAL_ID,o=function(t,e){var i;if(e===s)return(null!==(i=t.damageType)&&void 0!==i?i:Pt.BN.MAGICAL)===Pt.BN.PHYSICAL;var o=t.elementType;if(void 0===o)return!1;switch(e){case a:return 2===o;case n:return 1===o}return!1},r=this.data.actions.CONDENSED_LIBRA;this.buffHistory[a]=this.newBuffHistory(r,o),this.buffHistory[n]=this.newBuffHistory(r,o),this.buffHistory[s]=this.newBuffHistory(r,o);var l=(0,gt.hX)().status((0,gt.kw)(Zt()(t=Ct()(this.buffHistory)).call(t,Number))).target((function(t){return e.actors.get(t).team!==Bt.S.FRIEND}));this.addEventHook(l.type("statusApply"),this.onApplyRaidBuff),this.addEventHook(l.type("statusRemove"),this.onRemoveRaidBuff),this.addEventHook("complete",this.onComplete)}},{key:"isDupedEvent",value:function(t,e){if(void 0===e)return!1;if(t.status===e.status&&t.source===e.source){var i=t.timestamp-e.timestamp;if(i>=-100&&i<=100)return!0}return!1}},{key:"onApplyRaidBuff",value:function(t){var e,i;if(!this.isDupedEvent(t,this.previousApply)){this.previousApply=t;var a=this.buffHistory[t.status],n=a.getCurrent();switch(void 0!==n&&(n.start-t.timestamp>2e3&&(n.data.overwritten=!0),a.closeCurrent(t.timestamp)),t.status){case this.OFF_GUARD_ID:this.inOffGuard=!0;break;case this.PECULIAR_LIGHT_ID:this.inPeculiarLight=!0;break;case this.CONDENSED_LIBRA_ASTRAL_ID:case this.CONDENSED_LIBRA_UMBRAL_ID:case this.CONDENSED_LIBRA_PHYSICAL_ID:this.inLibra=!0}var s=a.openNew(t.timestamp);if(s.data.buffId=t.status,t.source===this.actors.current.id&&(s.data.ours=!0),void 0===this.buffActionHook){var o=Zt()(e=ft()(i=this.parser.pull.actors).call(i,(function(t){return t.team===Bt.S.FRIEND}))).call(e,(function(t){return t.id})),r=(0,gt.hX)().source((0,gt.kw)(o)).type("action");this.buffActionHook=this.addEventHook(r,this.onActionDuringBuff)}}}},{key:"onRemoveRaidBuff",value:function(t){if(!this.isDupedEvent(t,this.previousRemove)){this.previousRemove=t;var e=this.data.getStatus(t.status);if(void 0!==e){var i,a=this.buffHistory[t.status],n=a.getCurrent();if(void 0!==n&&void 0!==e)if((null!==(i=e.duration)&&void 0!==i?i:15e3)-2e3>t.timestamp-n.start)n.data.overwritten=!0;else switch(t.status){case this.OFF_GUARD_ID:this.inOffGuard=!1;break;case this.PECULIAR_LIGHT_ID:this.inPeculiarLight=!1;break;case this.CONDENSED_LIBRA_ASTRAL_ID:case this.CONDENSED_LIBRA_UMBRAL_ID:case this.CONDENSED_LIBRA_PHYSICAL_ID:this.inLibra=!1}a.closeCurrent(t.timestamp);var s=!this.inPeculiarLight&&!this.inOffGuard&&!this.inLibra;null!=this.buffActionHook&&s&&(this.removeEventHook(this.buffActionHook),this.buffActionHook=void 0)}}}},{key:"onActionDuringBuff",value:function(t){var e=this;Ot()(this.buffHistory).forEach((function(i){var a=i.getCurrent();void 0!==a&&a.data.events.push({action:t.action,underPL:e.inPeculiarLight,underOG:e.inOffGuard,underLibra:e.inLibra})}))}},{key:"onComplete",value:function(){var t=this;Ot()(this.buffHistory).forEach((function(e){e.closeCurrent(t.parser.pull.timestamp+t.parser.pull.duration)})),[this.data.statuses.PECULIAR_LIGHT,this.data.statuses.OFF_GUARD].forEach((function(e){var i,a=t.buffHistory[e.id],n=ft()(i=Ht()(a)).call(i,(function(t){return t.data.overwritten&&t.data.ours})).length;t.suggestions.add(new bt.eg({icon:e.icon,content:(0,It.jsx)(pt.Trans,{id:"blu.buffs.overwritten.content",defaults:"Your <0/> was overwritten by someone else before it ran out.  This might be reasonable depending on the fight, but worth examining and figuring out if your team needs to coordinate buffs.",components:[(0,It.jsx)(vt.ci,(0,At.Z)({},e))]}),tiers:{1:bt.bI.MEDIUM},value:n,why:(0,It.jsx)(pt.Trans,{id:"blu.buffs.overwritten.why",defaults:"{0, plural, one {# application was } other {# applications were}} overwritten by someone else",values:{0:null!=n?n:0}})}))}))}},{key:"output",value:function(){var t,e,i,a,n=this,s=St()(t=Lt()(e=Zt()(i=Ot()(this.buffHistory)).call(i,(function(t){return Ht()(t)}))).call(e)).call(t,(function(t,e){return t.start-e.start}));if(0!==s.length){var o=ft()(s).call(s,(function(t){return t.data.ours}));if(0!==o.length){var r=ft()(a=Zt()(o).call(o,(function(t){var e,i,a=t.start-n.parser.pull.timestamp,s=(null!==(e=t.end)&&void 0!==e?e:t.start)-n.parser.pull.timestamp,o=t.data.buffId,r=t.data.isBuffedAction,l=ft()(i=t.data.events).call(i,(function(t){var e=n.data.getAction(t.action);if(void 0!==e&&void 0!==(null==e?void 0:e.damageType))return!!r(e,o)||void 0})),u=0,c=0,d=0;return l.forEach((function(t){t.underPL&&c++,t.underOG&&u++,t.underLibra&&d++})),{start:a,end:s,buffAction:t.data.buffAction,buffStatus:n.data.getStatus(o),ogBuffed:u,plBuffed:c,libraBuffed:d}}))).call(a,(function(t){return void 0!==t}));if(0!==r.length)return(0,It.jsxs)(Et.Fragment,{children:[(0,It.jsx)(Mt.Z,{children:(0,It.jsx)(pt.Trans,{id:"blu.buffs.table.message",defaults:"Blue Mages can keep both <0/> and <1/> up for the entire duration of the fight, and may opt to have the <2/> buffs running as well.<3/>The table below shows when you used your buffs, as well as how many damaging party actions the buff covered; it also shows how many of those actions were also covered by the other two buffs.  Ideally your team should coordinate to have <4/> and <5/> running all the time, making both numbers below equal.",components:[(0,It.jsx)(vt.vm,{action:"OFF_GUARD"}),(0,It.jsx)(vt.vm,{action:"PECULIAR_LIGHT"}),(0,It.jsx)(vt.vm,{action:"CONDENSED_LIBRA"}),(0,It.jsx)("br",{}),(0,It.jsx)(vt.vm,{action:"OFF_GUARD",showIcon:!1}),(0,It.jsx)(vt.vm,{action:"PECULIAR_LIGHT",showIcon:!1})]})}),(0,It.jsxs)(Wt.Z,{compact:!0,unstackable:!0,celled:!0,collapsing:!0,children:[(0,It.jsx)(Wt.Z.Header,{children:(0,It.jsxs)(Wt.Z.Row,{children:[(0,It.jsx)(Wt.Z.HeaderCell,{children:(0,It.jsx)(pt.Trans,{id:"blu.buffs.buff_time",defaults:"Time"})}),(0,It.jsx)(Wt.Z.HeaderCell,{children:(0,It.jsx)(pt.Trans,{id:"blu.buffs.buff_yours",defaults:"Your Buff"})}),(0,It.jsx)(Wt.Z.HeaderCell,{children:(0,It.jsx)(vt.P9,{action:"OFF_GUARD"})}),(0,It.jsx)(Wt.Z.HeaderCell,{children:(0,It.jsx)(vt.P9,{action:"PECULIAR_LIGHT"})}),(0,It.jsx)(Wt.Z.HeaderCell,{children:(0,It.jsx)(vt.P9,{action:"CONDENSED_LIBRA"})})]})}),(0,It.jsx)(Wt.Z.Body,{children:Zt()(r).call(r,(function(t){return(0,It.jsxs)(Wt.Z.Row,{children:[(0,It.jsxs)(Wt.Z.Cell,{textAlign:"center",children:[(0,It.jsx)("span",{style:{marginRight:5},children:n.parser.formatEpochTimestamp(t.start+n.parser.pull.timestamp)}),(0,It.jsx)(zt.Z,{circular:!0,compact:!0,size:"mini",icon:"time",onClick:function(){return n.timeline.show(t.start,t.end)}})]}),(0,It.jsxs)(Wt.Z.Cell,{children:[" ",(0,It.jsx)(vt.ci,(0,At.Z)({},t.buffStatus))]}),(0,It.jsx)(Wt.Z.Cell,{children:t.ogBuffed}),(0,It.jsx)(Wt.Z.Cell,{children:t.plBuffed}),(0,It.jsx)(Wt.Z.Cell,{children:t.libraBuffed})]},t.start)}))})]})]})}}}}]),i}(Ft.qk),C.handle="buffwindows",C.title={id:"blu.buffs.title",defaults:"Buff Windows"},C.displayOrder=4,T=k,A=(0,ut.Z)(T.prototype,"actors",[mt.I,w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return this.actors}}),R=(0,ut.Z)(T.prototype,"data",[mt.I,b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return this.data}}),Z=(0,ut.Z)(T.prototype,"suggestions",[mt.I,E],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return this.suggestions}}),_=(0,ut.Z)(T.prototype,"timeline",[mt.I,I],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return this.timeline}}),T),Xt={DROPPED_COLD_FOG:{1:bt.bI.MAJOR},DROPPED_WHITE_DEATH_CASTS:{1:bt.bI.MEDIUM},INEFFECTIVE_COLD_FOG:{1:bt.bI.MAJOR}},Yt=(O=Reflect.metadata("design:type",yt.e),D=Reflect.metadata("design:type",jt.V),H=Reflect.metadata("design:type",bt.ZP),F=P=function(t){(0,l.Z)(i,t);var e=(0,u.Z)(i);function i(){var t,a;(0,r.Z)(this,i);for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return a=e.call.apply(e,d()(t=[this]).call(t,s)),(0,nt.Z)(a,"actors",S,(0,ot.Z)(a)),(0,nt.Z)(a,"data",x,(0,ot.Z)(a)),(0,nt.Z)(a,"suggestions",L,(0,ot.Z)(a)),a.touchOfFrostProcs=0,a.coldFogCasts=0,a.currentHook=void 0,a.touchOfFrostHistory=new Ut.A((function(){return{whiteDeathCasts:0}})),a}return(0,st.Z)(i,[{key:"initialise",value:function(){(0,rt.Z)((0,lt.Z)(i.prototype),"initialise",this).call(this);var t=(0,gt.hX)().source(this.parser.actor.id);this.addEventHook(t.type("statusApply").status(this.data.statuses.TOUCH_OF_FROST.id),this.onApplyTouchOfFrost),this.addEventHook(t.type("statusRemove").status(this.data.statuses.TOUCH_OF_FROST.id),this.onRemoveTouchOfFrost),this.addEventHook(t.type("statusApply").status(this.data.statuses.COLD_FOG.id),this.onApplyColdFog),this.addEventHook("complete",this.onComplete)}},{key:"onApplyTouchOfFrost",value:function(t){if(this.touchOfFrostHistory.openNew(t.timestamp),void 0===this.currentHook){var e=(0,gt.hX)().source(this.parser.actor.id);this.currentHook=this.addEventHook(e.action(this.data.actions.WHITE_DEATH.id).type("action"),this.onWhiteDeath)}}},{key:"onRemoveTouchOfFrost",value:function(){this.touchOfFrostHistory.closeCurrent(this.parser.pull.timestamp+this.parser.pull.duration),void 0!==this.currentHook&&this.removeEventHook(this.currentHook)}},{key:"onWhiteDeath",value:function(t){var e=this.touchOfFrostHistory.getCurrent();null!=e&&t.action===this.data.actions.WHITE_DEATH.id&&e.data.whiteDeathCasts++}},{key:"onApplyColdFog",value:function(){this.coldFogCasts++}},{key:"onComplete",value:function(){var t,e,i,a=this.coldFogCasts-Ht()(this.touchOfFrostHistory).length;this.suggestions.add(new bt.eg({icon:this.data.actions.COLD_FOG.icon,content:(0,It.jsx)(pt.Trans,{id:"blu.coldfog.dropped.content",defaults:"Any damage taken while the <0/> effect is active grants the <1/>buff, allowing the use of <2/> for 15 seconds. You should ensure you can proc every cast of <3/>.",components:[(0,It.jsx)(vt.P9,{status:"COLD_FOG"}),(0,It.jsx)(vt.P9,{status:"TOUCH_OF_FROST"}),(0,It.jsx)(vt.P9,{action:"WHITE_DEATH"}),(0,It.jsx)(vt.P9,{action:"COLD_FOG"})]}),tiers:Xt.DROPPED_COLD_FOG,value:a,why:(0,It.jsx)(pt.Trans,{id:"blu.coldfog.dropped.why",defaults:"{0, plural, one {# Cold Fog use} other {# Cold Fog uses}} did not proc <0/>",values:{0:null!=a?a:0},components:[(0,It.jsx)(vt.P9,{action:"WHITE_DEATH",showIcon:!1,showTooltip:!1})]})}));var n=ft()(t=Ht()(this.touchOfFrostHistory)).call(t,(function(t){return t.data.whiteDeathCasts<2})).length;this.suggestions.add(new bt.eg({icon:this.data.actions.COLD_FOG.icon,content:(0,It.jsx)(pt.Trans,{id:"blu.coldfog.ineffective.content",defaults:"For <0/> to be effective, you need to cast <1/>at least two times while under <2/>.",components:[(0,It.jsx)(vt.P9,{action:"COLD_FOG"}),(0,It.jsx)(vt.P9,{action:"WHITE_DEATH"}),(0,It.jsx)(vt.P9,{status:"TOUCH_OF_FROST"})]}),tiers:Xt.INEFFECTIVE_COLD_FOG,value:n,why:(0,It.jsx)(pt.Trans,{id:"blu.coldfog.ineffective.why",defaults:"{0, plural, one {# Cold Fog use} other {# Cold Fog uses}} were a DPS loss due to not using<0/> enough times",values:{0:null!=n?n:0},components:[(0,It.jsx)(vt.P9,{action:"WHITE_DEATH",showIcon:!1,showTooltip:!1})]})}));var s=ft()(e=ft()(i=Ht()(this.touchOfFrostHistory)).call(i,(function(t){return t.data.whiteDeathCasts>=2}))).call(e,(function(t){return t.data.whiteDeathCasts<6})).length;this.suggestions.add(new bt.eg({icon:this.data.actions.COLD_FOG.icon,content:(0,It.jsx)(pt.Trans,{id:"blu.coldfog.dropped_casts.content",defaults:"<0/> should be cast 6 or 7 times (depending on spell speed) for each <1/> cast.",components:[(0,It.jsx)(vt.P9,{action:"WHITE_DEATH"}),(0,It.jsx)(vt.P9,{action:"COLD_FOG"})]}),tiers:Xt.DROPPED_WHITE_DEATH_CASTS,value:s,why:(0,It.jsx)(pt.Trans,{id:"blu.coldfog.dropped_casts.why",defaults:"{0, plural, one {# Cold Fog use} other {# Cold Fog uses}} cast <0/> less than 6 times.",values:{0:null!=s?s:0},components:[(0,It.jsx)(vt.P9,{action:"WHITE_DEATH",showIcon:!1,showTooltip:!1})]})}))}}]),i}(Ft.qk),P.handle="coldfog",P.title={id:"blu.cold_fog.title",defaults:"Cold Fog"},N=F,S=(0,ut.Z)(N.prototype,"actors",[mt.I,O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return this.actors}}),x=(0,ut.Z)(N.prototype,"data",[mt.I,D],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return this.data}}),L=(0,ut.Z)(N.prototype,"suggestions",[mt.I,H],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return this.suggestions}}),N),Vt=i(44971),qt=(U=Reflect.metadata("design:type",jt.V),j=function(t){(0,l.Z)(i,t);var e=(0,u.Z)(i);function i(){var t,a;(0,r.Z)(this,i);for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return a=e.call.apply(e,d()(t=[this]).call(t,s)),(0,nt.Z)(a,"mydata",G,(0,ot.Z)(a)),a.isFinalSting=!1,a}return(0,st.Z)(i,[{key:"initialise",value:function(){(0,rt.Z)((0,lt.Z)(i.prototype),"initialise",this).call(this),this.addEventHook((0,gt.hX)().source(this.parser.actor.id).type("action").action((0,gt.kw)([this.mydata.actions.FINAL_STING.id,this.mydata.actions.SELF_DESTRUCT.id])),this.onFinalSting)}},{key:"onFinalSting",value:function(){this.isFinalSting=!0}},{key:"shouldCountDeath",value:function(t){return t.actor!==this.parser.actor.id||!this.isFinalSting||(this.isFinalSting=!1,!1)}}]),i}(Vt.h),G=(0,ut.Z)(j.prototype,"mydata",[mt.I,U],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return this.mydata}}),j),Jt=function(t){(0,l.Z)(i,t);var e=(0,u.Z)(i);function i(){var t,a;(0,r.Z)(this,i);for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return(a=e.call.apply(e,d()(t=[this]).call(t,s))).trackedDefensives=[a.data.actions.ADDLE,a.data.actions.MAGIC_HAMMER],a}return i}(i(12541).O),Qt=i(52102),$t=i(49006),te={UNBUFFED_SOT:{1:bt.bI.MINOR},CLIPPING:{6e3:bt.bI.MINOR,9e3:bt.bI.MEDIUM,12e3:bt.bI.MAJOR},UPTIME:{90:Qt.hI.WARN,95:Qt.hI.SUCCESS}},ee=(B=Reflect.metadata("design:type",yt.e),M=Reflect.metadata("design:type",Qt.ZP),W=Reflect.metadata("design:type",bt.ZP),z=function(t){(0,l.Z)(i,t);var e=(0,u.Z)(i);function i(){var t,a;(0,r.Z)(this,i);for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return a=e.call.apply(e,d()(t=[this]).call(t,s)),(0,nt.Z)(a,"myactors",K,(0,ot.Z)(a)),(0,nt.Z)(a,"checklist",X,(0,ot.Z)(a)),(0,nt.Z)(a,"suggestions",Y,(0,ot.Z)(a)),a.bristleId=void 0,a.unbuffedSongsOfTorment=0,a.trackedStatuses=[a.data.statuses.BLEEDING.id],a}return(0,st.Z)(i,[{key:"initialise",value:function(){(0,rt.Z)((0,lt.Z)(i.prototype),"initialise",this).call(this),this.bristleId=this.data.statuses.BRISTLE.id;var t=(0,gt.hX)().source(this.parser.actor.id);this.addEventHook(t.type("action").action(this.data.actions.SONG_OF_TORMENT.id),this.onApplyingSoT),this.addEventHook((0,gt.hX)().type("complete"),this.onCompleteExtra)}},{key:"onApplyingSoT",value:function(){void 0!==this.bristleId&&(this.myactors.current.hasStatus(this.bristleId)||this.unbuffedSongsOfTorment++)}},{key:"onCompleteExtra",value:function(){var t;this.suggestions.add(new bt.eg({icon:this.data.actions.SONG_OF_TORMENT.icon,content:(0,It.jsx)(pt.Trans,{id:"blu.song_of_torment.suggestion.unbuffed.content",defaults:"Ideally every <0/> should be buffed by first using <1/>. This is a minor potency gain.",components:[(0,It.jsx)(vt.P9,{action:"SONG_OF_TORMENT"}),(0,It.jsx)(vt.P9,{action:"BRISTLE"})]}),tiers:te.UNBUFFED_SOT,why:(0,It.jsx)(pt.Trans,{id:"blu.song_of_torment.suggestion.unbuffed.why",defaults:"{0, plural, one {# Song of Torment was} other {# Songs of Torment were}} not buffed.",values:{0:null!==(t=this.unbuffedSongsOfTorment)&&void 0!==t?t:0}}),value:this.unbuffedSongsOfTorment}))}},{key:"addChecklistRules",value:function(){var t=this.getUptimePercent(this.data.statuses.BLEEDING.id);this.checklist.add(new Qt.dV({name:(0,It.jsx)(pt.Trans,{id:"blu.dots.rule.name",defaults:"Keep your DoTs up"}),description:(0,It.jsx)(pt.Trans,{id:"blu.dots.rule.description",defaults:"The <0/> effect from Nightbloom and SoT is a solid 15% of your total damage.",components:[(0,It.jsx)(vt.P9,{status:"BLEEDING",showIcon:!1,showTooltip:!1})]}),tiers:te.UPTIME,requirements:[new Qt.nb({name:(0,It.jsx)(pt.Trans,{id:"blu.dots.requirement.uptime-bleed.name",defaults:"<0/> uptime",components:[(0,It.jsx)(vt.P9,{status:"BLEEDING"})]}),percent:t})]}))}},{key:"addClippingSuggestions",value:function(){var t=this.getClippingAmount(this.data.statuses.BLEEDING.id);this.suggestions.add(new bt.eg({icon:this.data.actions.SONG_OF_TORMENT.icon,content:(0,It.jsx)(pt.Trans,{id:"blu.dots.suggestion.clip-bleed.content",defaults:"Avoid refreshing Song of Torment significantly before its expiration, this will allow you to cast more Sonic Boom."}),tiers:te.CLIPPING,value:t,why:(0,It.jsx)(pt.Trans,{id:"blu.dots.suggestion.clip-bleed.why",defaults:"An average of {0} of <0/> clipped per minute due to early refreshes.",values:{0:this.parser.formatDuration(t)},components:[(0,It.jsx)(vt.P9,{status:"BLEEDING"})]})}))}}]),i}($t.N),K=(0,ut.Z)(z.prototype,"myactors",[mt.I,B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return this.myactors}}),X=(0,ut.Z)(z.prototype,"checklist",[mt.I,M],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return this.checklist}}),Y=(0,ut.Z)(z.prototype,"suggestions",[mt.I,W],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return this.suggestions}}),z),ie=i(44845),ae=i(39392),ne=i.n(ae),se=i(74407),oe=i(51691),re=(V=Reflect.metadata("design:type",jt.V),q=Reflect.metadata("design:type",bt.ZP),J=Reflect.metadata("design:type",oe.Z),at=it=function(t){(0,l.Z)(i,t);var e=(0,u.Z)(i);function i(){var t,a,n;(0,r.Z)(this,i);for(var s=arguments.length,o=new Array(s),l=0;l<s;l++)o[l]=arguments[l];return n=e.call.apply(e,d()(t=[this]).call(t,o)),(0,nt.Z)(n,"data",$,(0,ot.Z)(n)),(0,nt.Z)(n,"suggestions",tt,(0,ot.Z)(n)),(0,nt.Z)(n,"downtime",et,(0,ot.Z)(n)),n.currentBuffs=new(ne()),n.misusedBuffs=(a={},(0,ie.Z)(a,se.ZP.BRISTLE.id,{dropped:0,overwrote:0,duration:se.ZP.BRISTLE.duration}),(0,ie.Z)(a,se.ZP.WHISTLE.id,{dropped:0,overwrote:0,duration:se.ZP.WHISTLE.duration}),(0,ie.Z)(a,se.ZP.TINGLING.id,{dropped:0,overwrote:0,duration:se.ZP.TINGLING.duration}),a),n}return(0,st.Z)(i,[{key:"initialise",value:function(){var t,e=(0,gt.hX)().source(this.parser.actor.id).status((0,gt.kw)(Zt()(t=Ct()(this.misusedBuffs)).call(t,Number)));this.addEventHook(e.type("statusApply"),this.onGainBuff),this.addEventHook(e.type("statusRemove"),this.onRemoveBuff),this.addEventHook({type:"death",actor:this.parser.actor.id},this.onDeath),this.addEventHook("complete",this.onComplete)}},{key:"onRemoveBuff",value:function(t){if(this.currentBuffs.has(t.status)){var e,i=null!==(e=this.currentBuffs.get(t.status))&&void 0!==e?e:t.timestamp;t.timestamp-i>=this.misusedBuffs[t.status].duration&&this.misusedBuffs[t.status].dropped++}this.currentBuffs.delete(t.status)}},{key:"onGainBuff",value:function(t){var e=this.currentBuffs.get(t.status);this.currentBuffs.set(t.status,t.timestamp),void 0!==e&&(this.downtime.getDowntime(t.timestamp-2,t.timestamp)>=0||this.misusedBuffs[t.status].overwrote++)}},{key:"onDeath",value:function(){this.currentBuffs.clear()}},{key:"suggestOnDroppedStatus",value:function(t,e){var i=this.data.getStatus(t);void 0!==i&&this.suggestions.add(new bt.eg({icon:i.icon,content:(0,It.jsx)(pt.Trans,{id:"blu.droppedbuffs.suggestions.dropped.content",defaults:"<0/> fell off without being used.",components:[(0,It.jsx)(vt.ci,(0,At.Z)({},i))]}),tiers:{1:bt.bI.MEDIUM},value:e,why:(0,It.jsx)(pt.Trans,{id:"blu.droppedbuffs.suggestions.dropped.why",defaults:"{0, plural, one {# Use of } other {# Uses of }} <0/> expired.",values:{0:null!=e?e:0},components:[(0,It.jsx)(vt.ci,(0,At.Z)((0,At.Z)({},i),{},{showIcon:!1}))]})}))}},{key:"suggestOnOverwrittenStatus",value:function(t,e){var i=this.data.getStatus(t);void 0!==i&&this.suggestions.add(new bt.eg({icon:i.icon,content:(0,It.jsx)(pt.Trans,{id:"blu.droppedbuffs.suggestions.overwritten.content",defaults:"<0/> was overwritten.",components:[(0,It.jsx)(vt.ci,(0,At.Z)({},i))]}),tiers:{1:bt.bI.MEDIUM},value:e,why:(0,It.jsx)(pt.Trans,{id:"blu.droppedbuffs.suggestions.overwritten.why",defaults:"{0, plural, one {# Use of } other {# Uses of }} <0/> were overwritten.",values:{0:null!=e?e:0},components:[(0,It.jsx)(vt.ci,(0,At.Z)((0,At.Z)({},i),{},{showIcon:!1}))]})}))}},{key:"onComplete",value:function(){var t,e=this;Zt()(t=Ct()(this.misusedBuffs)).call(t,Number).forEach((function(t){e.suggestOnDroppedStatus(t,e.misusedBuffs[t].dropped),e.suggestOnOverwrittenStatus(t,e.misusedBuffs[t].overwrote)}))}}]),i}(Ft.qk),it.handle="droppedbuffs",Q=at,$=(0,ut.Z)(Q.prototype,"data",[mt.I,V],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return this.data}}),tt=(0,ut.Z)(Q.prototype,"suggestions",[mt.I,q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return this.suggestions}}),et=(0,ut.Z)(Q.prototype,"downtime",[mt.I,J],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return this.downtime}}),Q),le=function(t){(0,l.Z)(i,t);var e=(0,u.Z)(i);function i(){var t,a;(0,r.Z)(this,i);for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return(a=e.call.apply(e,d()(t=[this]).call(t,s))).defaultAllowedAverageDowntime=1e3,a.trackedCds=[{cooldowns:[a.data.actions.NIGHTBLOOM],firstUseOffset:5e3},{cooldowns:[a.data.actions.PHANTOM_FLURRY],firstUseOffset:19e3},{cooldowns:[a.data.actions.FEATHER_RAIN,a.data.actions.ERUPTION],firstUseOffset:15e3},{cooldowns:[a.data.actions.SHOCK_STRIKE],firstUseOffset:15e3},{cooldowns:[a.data.actions.GLASS_DANCE],firstUseOffset:12500,allowedAverageDowntime:3e4},{cooldowns:[a.data.actions.J_KICK,a.data.actions.QUASAR],firstUseOffset:2500},{cooldowns:[a.data.actions.TRIPLE_TRIDENT],firstUseOffset:2500,allowedAverageDowntime:3e4},{cooldowns:[a.data.actions.THE_ROSE_OF_DESTRUCTION],firstUseOffset:5e3},{cooldowns:[a.data.actions.COLD_FOG],firstUseOffset:3e4},{cooldowns:[a.data.actions.OFF_GUARD,a.data.actions.PECULIAR_LIGHT],firstUseOffset:5e4}],a.suggestionOnlyCooldowns=[{cooldowns:[a.data.actions.MATRA_MAGIC]},{cooldowns:[a.data.actions.DRAGON_FORCE]},{cooldowns:[a.data.actions.ANGELS_SNACK]}],a}return i}(i(48945).u),ue=function(t){(0,l.Z)(i,t);var e=(0,u.Z)(i);function i(){var t,a;(0,r.Z)(this,i);for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return(a=e.call.apply(e,d()(t=[this]).call(t,s))).suggestionContent=(0,It.jsx)(pt.Trans,{id:"blu.interrupts.suggestion.content",defaults:"Blue Mage has few movement tools; our <0/> will either be used during the <1/> window, or be left in reserve for a resurrect.  In very select circumstances <2/> can be used to get 15 seconds of free movement, but this is rare.  Generally, you will want to pre-position and use slidecast windows as much as you can.",components:[(0,It.jsx)(vt.P9,{action:"SWIFTCAST"}),(0,It.jsx)(vt.P9,{action:"MOON_FLUTE"}),(0,It.jsx)(vt.P9,{action:"COLD_FOG"})]}),a}return i}(i(48989).e);ue.displayOrder=1;var ce,de,he,fe,pe,ve,ge,me,ye,we,be,Ee,Ie,Te,Ae,Re,Ze,_e,Ce,ke,Oe,De,He,Ne,Se,xe,Le,Pe,Fe,Ue,je,Ge,Be,Me,We,ze,Ke=i(73905),Xe=i(37517),Ye=i(83459),Ve={MISSING_EXPECTED_USES:{1:bt.bI.MINOR,2:bt.bI.MEDIUM,3:bt.bI.MAJOR},TOO_FEW_GCDS:{8:bt.bI.MAJOR}},qe=(ce=Reflect.metadata("design:type",Ye.E),pe=fe=function(t){(0,l.Z)(i,t);var e=(0,u.Z)(i);function i(){var t,a;(0,r.Z)(this,i);for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return a=e.call.apply(e,d()(t=[this]).call(t,s)),(0,nt.Z)(a,"globalCooldown",he,(0,ot.Z)(a)),a.buffStatus=a.data.statuses.WAXING_NOCTURNE,a}return(0,st.Z)(i,[{key:"initialise",value:function(){(0,rt.Z)((0,lt.Z)(i.prototype),"initialise",this).call(this);var t=this.data.actions.MOON_FLUTE.icon,e=(0,It.jsx)(vt.vm,{action:"MOON_FLUTE",showIcon:!1});this.addEvaluator(new Xe.nZ({expectedGcds:5,globalCooldown:this.globalCooldown,suggestionIcon:t,suggestionContent:(0,It.jsx)(pt.Trans,{id:"blu.moonflutes.suggestions.gcds.content",defaults:"Regardless of spell speed, ideally a <0/> window should contain at least 4 GCDs and end in <1/>.  If you have higher latency this can be problematic; changing your speed speed might help, and in a pinch you can try moving certain oGCDs out of the window (<2/>, <3/>,<4/>), or replacing <5/>with a <6/>.",components:[(0,It.jsx)(vt.vm,{action:"MOON_FLUTE"}),(0,It.jsx)(vt.vm,{action:"PHANTOM_FLURRY"}),(0,It.jsx)(vt.vm,{action:"J_KICK"}),(0,It.jsx)(vt.vm,{action:"GLASS_DANCE"}),(0,It.jsx)(vt.vm,{action:"FEATHER_RAIN"}),(0,It.jsx)(vt.vm,{action:"THE_ROSE_OF_DESTRUCTION"}),(0,It.jsx)(vt.vm,{action:"SONIC_BOOM"})]}),suggestionWindowName:e,severityTiers:Ve.TOO_FEW_GCDS,hasStacks:!1,adjustCount:this.adjustExpectedGcdCount.bind(this)}));var a=new Je({expectedActions:[{action:this.data.actions.J_KICK,expectedPerWindow:1},{action:this.data.actions.TRIPLE_TRIDENT,expectedPerWindow:1},{action:this.data.actions.NIGHTBLOOM,expectedPerWindow:1},{action:this.data.actions.THE_ROSE_OF_DESTRUCTION,expectedPerWindow:1},{action:this.data.actions.SHOCK_STRIKE,expectedPerWindow:1},{action:this.data.actions.BRISTLE,expectedPerWindow:1},{action:this.data.actions.GLASS_DANCE,expectedPerWindow:1},{action:this.data.actions.SURPANAKHA,expectedPerWindow:4},{action:this.data.actions.FEATHER_RAIN,expectedPerWindow:1},{action:this.data.actions.MATRA_MAGIC,expectedPerWindow:1},{action:this.data.actions.PHANTOM_FLURRY,expectedPerWindow:1}],suggestionIcon:t,suggestionContent:(0,It.jsx)(pt.Trans,{id:"blu.moonflutes.suggestions.expected-actions.content",defaults:"<0/> is only worth using if the buffed actions during the window will give you an extra 1260 potency (equivalent to casting <1/> six times). The more of your larger cooldowns you can fit into the window, the better the result.  High-priority targets are <2/>, and finishing the combo with a <3/>.",components:[(0,It.jsx)(vt.vm,{action:"MOON_FLUTE"}),(0,It.jsx)(vt.vm,{action:"SONIC_BOOM"}),(0,It.jsx)(vt.vm,{action:"NIGHTBLOOM"}),(0,It.jsx)(vt.vm,{action:"PHANTOM_FLURRY"})]}),suggestionWindowName:e,severityTiers:Ve.MISSING_EXPECTED_USES,adjustOutcome:this.adjustExpectedActionOutcome.bind(this)});a.setAltAction(this.data.actions.FEATHER_RAIN,this.data.actions.ERUPTION),a.setAltAction(this.data.actions.SHOCK_STRIKE,this.data.actions.BLU_MOUNTAIN_BUSTER),a.setAltAction(this.data.actions.J_KICK,this.data.actions.QUASAR),this.addEvaluator(a)}},{key:"adjustExpectedGcdCount",value:function(t){var e,i=this;return ft()(e=t.data).call(e,(function(t){return t.action.id===i.data.actions.FINAL_STING.id||t.action.id===i.data.actions.SELF_DESTRUCT.id})).length>=1?1-t.data.length:0}},{key:"adjustExpectedActionOutcome",value:function(t,e){var i,a=this;if(0!==ft()(i=t.data).call(i,(function(t){return t.action.id===a.data.actions.FINAL_STING.id||t.action.id===a.data.actions.SELF_DESTRUCT.id})).length)return function(t,e){return void 0!==e&&t===e?Ke.m.POSITIVE:Ke.m.NEUTRAL}}}]),i}(Xe.xl),fe.handle="moonflutes",fe.title={id:"blu.moonflutes.title",defaults:"Moon Flute Windows"},de=pe,he=(0,ut.Z)(de.prototype,"globalCooldown",[mt.I,ce],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return this.globalCooldown}}),de),Je=function(t){(0,l.Z)(i,t);var e=(0,u.Z)(i);function i(){var t,a;(0,r.Z)(this,i);for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return(a=e.call.apply(e,d()(t=[this]).call(t,s))).altActions=new(ne()),a.foundAltActions=new(ne()),a}return(0,st.Z)(i,[{key:"setAltAction",value:function(t,e){this.altActions.set(t.id,e)}},{key:"countUsed",value:function(t,e){var a=this.altActions.get(e.action.id);if(void 0!==a){var n,s=a.id,o=ft()(n=t.data).call(n,(function(t){return t.action.id===s})).length;if(o>0)return this.foundAltActions.set(e.action.id,a),o}return(0,rt.Z)((0,lt.Z)(i.prototype),"countUsed",this).call(this,t,e)}},{key:"actionHeader",value:function(t){var e=this.foundAltActions.get(t.action.id);return void 0===e?(0,rt.Z)((0,lt.Z)(i.prototype),"actionHeader",this).call(this,t):(0,It.jsx)(vt.vm,(0,At.Z)({showName:!1},e))}}]),i}(Xe.np),Qe=i(95859),$e=i(26823),ti=(ve=Reflect.metadata("design:type",yt.e),ge=function(t){(0,l.Z)(i,t);var e=(0,u.Z)(i);function i(){var t,a;(0,r.Z)(this,i);for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return a=e.call.apply(e,d()(t=[this]).call(t,s)),(0,nt.Z)(a,"actors",me,(0,ot.Z)(a)),a.checklistRuleBreakout=!0,a.displayPieChart=!0,a.displaySuggestion=!0,a.suggestionIcon=Qe.ZP.POM_CURE.icon,a.trackedHealCategories=[{name:(0,It.jsx)(pt.Trans,{id:"blu.overheal.hot.name",defaults:"Healing Over Time"}),color:$e.Av[1],trackedHealIds:[a.data.statuses.ANGELS_SNACK.id,a.data.actions.ANGELS_SNACK.id]},{name:(0,It.jsx)(pt.Trans,{id:"blu.overheal.aoe.name",defaults:"AoE"}),color:$e.Av[2],trackedHealIds:[a.data.actions.STOTRAM.id,a.data.actions.EXUVIATION.id]},{name:(0,It.jsx)(pt.Trans,{id:"blu.overheal.white_wind.name",defaults:"White Wind"}),color:$e.Av[3],trackedHealIds:[a.data.actions.WHITE_WIND.id]}],a}return(0,st.Z)(i,[{key:"initialise",value:function(){this.addEventHook((0,gt.hX)().type("complete"),this.onCompleteExtra),(0,rt.Z)((0,lt.Z)(i.prototype),"initialise",this).call(this),this.addEventHook((0,gt.hX)().type("complete"),this.onCompleteExtra)}},{key:"considerHeal",value:function(t){return"action"!==t.cause.type||t.cause.action!==this.data.actions.DEVOUR.id}},{key:"onCompleteExtra",value:function(){var t,e=this;0===this.direct.heal+dt()(t=this.trackedOverheals).call(t,(function(t,i){return i.idIsTracked(e.data.actions.WHITE_WIND.id)?t:t+i.heal}),0)&&(this.checklistRuleBreakout=!1,this.displayPieChart=!1,this.displaySuggestion=!1,this.displayChecklist=!1,this.checklistRuleBreakout=!1)}}]),i}($e.Bv),me=(0,ut.Z)(ge.prototype,"actors",[mt.I,ve],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return this.actors}}),ge),ei=5e3,ii={WINDOW_MISSED:{1:bt.bI.MINOR,2:bt.bI.MINOR,3:bt.bI.MAJOR},CAST_OUT_OF_WINDOW:{1:bt.bI.MAJOR},UNWHISTLED_OPENING_REVENGE_BLAST:{1:bt.bI.MINOR}},ai=(ye=Reflect.metadata("design:type",yt.e),we=Reflect.metadata("design:type",jt.V),be=Reflect.metadata("design:type",bt.ZP),Ee=Reflect.metadata("design:type",Gt.TY),Ie=Reflect.metadata("design:type",oe.Z),Te=Reflect.metadata("design:type",Ye.E),He=De=function(t){(0,l.Z)(i,t);var e=(0,u.Z)(i);function i(){var t,a;(0,r.Z)(this,i);for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return a=e.call.apply(e,d()(t=[this]).call(t,s)),(0,nt.Z)(a,"actors",Re,(0,ot.Z)(a)),(0,nt.Z)(a,"data",Ze,(0,ot.Z)(a)),(0,nt.Z)(a,"suggestions",_e,(0,ot.Z)(a)),(0,nt.Z)(a,"timeline",Ce,(0,ot.Z)(a)),(0,nt.Z)(a,"downtime",ke,(0,ot.Z)(a)),(0,nt.Z)(a,"gcd",Oe,(0,ot.Z)(a)),a.badRevengeBlasts=0,a.inRevengeBlastWindow=!1,a.revengeBlastWindows=new Ut.A((function(){return{events:[],hadWhistle:!1,hadRevengeBlast:!1}})),a.actionHook=void 0,a}return(0,st.Z)(i,[{key:"initialise",value:function(){(0,rt.Z)((0,lt.Z)(i.prototype),"initialise",this).call(this);var t=(0,gt.hX)().source(this.parser.actor.id);this.addEventHook(t.type("action").action(this.data.actions.REVENGE_BLAST.id),this.onRevengeBlast),this.addEventHook(t.type((0,gt.kw)(["heal","damage"])),this.onActorUpdate),this.addEventHook((0,gt.hX)().type("actorUpdate").actor(this.parser.actor.id),this.onActorUpdate),this.addEventHook({type:"death",actor:this.parser.actor.id},this.onActorUpdate),this.addEventHook("complete",this.onComplete)}},{key:"onActorUpdate",value:function(t){var e=.18*this.actors.current.hp.maximum;if(this.actors.current.hp.current>0&&this.actors.current.hp.current<e){if(this.inRevengeBlastWindow)return;this.inRevengeBlastWindow=!0,this.revengeBlastWindows.openNew(t.timestamp),null==this.actionHook&&(this.actionHook=this.addEventHook((0,gt.hX)().source(this.parser.actor.id).type("action"),this.onRevengeBlastWindow))}else{if(!this.inRevengeBlastWindow)return;this.inRevengeBlastWindow=!1,this.revengeBlastWindows.closeCurrent(t.timestamp),null!=this.actionHook&&(this.removeEventHook(this.actionHook),this.actionHook=void 0)}}},{key:"onRevengeBlastWindow",value:function(t){var e=this;this.revengeBlastWindows.doIfOpen((function(i){i.hadRevengeBlast||t.action!==e.data.actions.REVENGE_BLAST.id||(e.actors.current.hasStatus(e.data.statuses.WHISTLE.id)&&(i.hadWhistle=!0),i.hadRevengeBlast=!0),i.events.push(t)}))}},{key:"onRevengeBlast",value:function(){var t=.2*this.actors.current.hp.maximum;this.actors.current.hp.current>t&&this.badRevengeBlasts++}},{key:"onComplete",value:function(){var t,e;this.revengeBlastWindows.closeCurrent(this.parser.pull.timestamp+this.parser.pull.duration),this.suggestions.add(new bt.eg({icon:this.data.actions.REVENGE_BLAST.icon,content:(0,It.jsx)(pt.Trans,{id:"blu.revenge_blast.bad.content",defaults:"Only use <0/> if your HP will be below 20% by the time the slidecast window starts.",components:[(0,It.jsx)(vt.P9,{action:"REVENGE_BLAST"})]}),tiers:ii.CAST_OUT_OF_WINDOW,value:this.badRevengeBlasts,why:(0,It.jsx)(pt.Trans,{id:"blu.revenge_blast.bad.why",defaults:"{0, plural, one {# Revenge Blast cast} other {# Revenge Blast casts}} happened when above 20% HP",values:{0:null!==(t=this.badRevengeBlasts)&&void 0!==t?t:0}})}));var i=ft()(e=Ht()(this.revengeBlastWindows)).call(e,(function(t){return t.data.hadRevengeBlast&&!t.data.hadWhistle})).length;this.suggestions.add(new bt.eg({icon:this.data.actions.REVENGE_BLAST.icon,content:(0,It.jsx)(pt.Trans,{id:"blu.revenge_blast.unwhistled.content",defaults:"If it won't drop a <0/> cast, you should cast <1/> before entering a <2/> window for a DPS gain over using your filler.",components:[(0,It.jsx)(vt.P9,{action:"REVENGE_BLAST"}),(0,It.jsx)(vt.P9,{action:"WHISTLE"}),(0,It.jsx)(vt.P9,{action:"REVENGE_BLAST",showIcon:!1})]}),tiers:ii.UNWHISTLED_OPENING_REVENGE_BLAST,value:i,why:(0,It.jsx)(pt.Trans,{id:"blu.revenge_blast.unwhistled.why",defaults:"{0, plural, one {# Revenge Blast window} other {# Revenge Blast windows}} did not have the <0/> buff.",values:{0:null!=i?i:0},components:[(0,It.jsx)(vt.P9,{action:"WHISTLE"})]})}))}},{key:"output",value:function(){var t,e=this;if(0!==Ht()(this.revengeBlastWindows).length){var i={header:(0,It.jsx)(pt.Trans,{id:"blu.revenge_blast.rotation-table.header.blast-count",defaults:"Revenge Blasts"}),accessor:"gcds"},a=this.gcd.getDuration()/1e3,n=this.data.actions.REVENGE_BLAST.id,s=this.data,o=this.downtime,r=[];if(ft()(t=Ht()(this.revengeBlastWindows)).call(t,(function(t){var e;return(null!==(e=t.end)&&void 0!==e?e:t.start)-t.start>ei})).forEach((function(t){var i,l,u,c,d=t.start-e.parser.pull.timestamp-2e3+500,h=(null!==(i=t.end)&&void 0!==i?i:t.start)-e.parser.pull.timestamp-2e3+500,f=o.getDowntime(t.start,null!==(l=t.end)&&void 0!==l?l:t.start);if(!(f>ei)){var p=h-d-f;if(!(p<ei)){var v=Math.floor(p/1e3/a),g={start:d,end:h,targetsData:{gcds:{actual:ft()(u=t.data.events).call(u,(function(t){var e;return(null===(e=s.getAction(t.action))||void 0===e?void 0:e.id)===n})).length,expected:v}},rotation:Zt()(c=t.data.events).call(c,(function(t){return{action:t.action}}))};r.push(g)}}})),0!==r.length)return(0,It.jsxs)(Et.Fragment,{children:[(0,It.jsx)(Mt.Z,{children:(0,It.jsx)(pt.Trans,{id:"blu.revenge_blast.table.message",defaults:"Finding windows to safely use <0/> is always a good idea.  Even small windows of two GCDs can be attractive -- If you fumble the timing and the second cast only does 50 potency, it is still a DPS gain over casting a filler GCD twice.",components:[(0,It.jsx)(vt.vm,{action:"REVENGE_BLAST"})]})}),(0,It.jsx)(Ke.y,{targets:[i],data:r,onGoto:this.timeline.show})]})}}}]),i}(Ft.qk),De.handle="revengeblast",De.title={id:"blu.revenge_blast.title",defaults:"Revenge Blast Windows"},De.displayOrder=3,Ae=He,Re=(0,ut.Z)(Ae.prototype,"actors",[mt.I,ye],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return this.actors}}),Ze=(0,ut.Z)(Ae.prototype,"data",[mt.I,we],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return this.data}}),_e=(0,ut.Z)(Ae.prototype,"suggestions",[mt.I,be],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return this.suggestions}}),Ce=(0,ut.Z)(Ae.prototype,"timeline",[mt.I,Ee],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return this.timeline}}),ke=(0,ut.Z)(Ae.prototype,"downtime",[mt.I,Ie],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return this.downtime}}),Oe=(0,ut.Z)(Ae.prototype,"gcd",[mt.I,Te],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return this.gcd}}),Ae),ni=function(t){(0,l.Z)(i,t);var e=(0,u.Z)(i);function i(){var t,a;(0,r.Z)(this,i);for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return(a=e.call.apply(e,d()(t=[this]).call(t,s))).suggestionContent=(0,It.jsx)(pt.Trans,{id:"blu.swiftcast.suggestion.content",defaults:"Cast a spell with <0/> before it expires.",components:[(0,It.jsx)(vt.P9,{action:"SWIFTCAST"})]}),a}return i}(i(48523).t),si=(Ne=Reflect.metadata("design:type",yt.e),Se=Reflect.metadata("design:type",jt.V),xe=Reflect.metadata("design:type",bt.ZP),Ge=je=function(t){(0,l.Z)(i,t);var e=(0,u.Z)(i);function i(){var t,a;(0,r.Z)(this,i);for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return a=e.call.apply(e,d()(t=[this]).call(t,s)),(0,nt.Z)(a,"actors",Pe,(0,ot.Z)(a)),(0,nt.Z)(a,"data",Fe,(0,ot.Z)(a)),(0,nt.Z)(a,"suggestions",Ue,(0,ot.Z)(a)),a.unbuffedTT=0,a}return(0,st.Z)(i,[{key:"initialise",value:function(){(0,rt.Z)((0,lt.Z)(i.prototype),"initialise",this).call(this);var t=(0,gt.hX)().source(this.parser.actor.id);this.addEventHook(t.type("action").action(this.data.actions.TRIPLE_TRIDENT.id),this.onTripleTrident),this.addEventHook("complete",this.onComplete)}},{key:"onTripleTrident",value:function(){var t=this.actors.current.hasStatus(this.data.statuses.WHISTLE.id),e=this.actors.current.hasStatus(this.data.statuses.TINGLING.id);t&&e||this.unbuffedTT++}},{key:"onComplete",value:function(){var t;this.suggestions.add(new bt.eg({icon:this.data.actions.TRIPLE_TRIDENT.icon,content:(0,It.jsx)(pt.Trans,{id:"blu.triple_trident.unbuffed.content",defaults:"<0/> should always be buffed with <1/> and <2/>.  For <3/> windows, you want to cast <4/> and <5/> before casting <6/>.",components:[(0,It.jsx)(vt.P9,{action:"TRIPLE_TRIDENT"}),(0,It.jsx)(vt.P9,{action:"WHISTLE"}),(0,It.jsx)(vt.P9,{action:"TINGLE"}),(0,It.jsx)(vt.P9,{action:"MOON_FLUTE"}),(0,It.jsx)(vt.P9,{action:"WHISTLE",showIcon:!1}),(0,It.jsx)(vt.P9,{action:"TINGLE",showIcon:!1}),(0,It.jsx)(vt.P9,{action:"MOON_FLUTE",showIcon:!1})]}),tiers:{1:bt.bI.MEDIUM},value:this.unbuffedTT,why:(0,It.jsx)(pt.Trans,{id:"blu.triple_trident.unbuffed.why",defaults:"{0, plural, one {# Triple Trident use} other {# Triple Trident uses}} were not buffed",values:{0:null!==(t=this.unbuffedTT)&&void 0!==t?t:0}})}))}}]),i}(Ft.qk),je.handle="tripletrident",Le=Ge,Pe=(0,ut.Z)(Le.prototype,"actors",[mt.I,Ne],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return this.actors}}),Fe=(0,ut.Z)(Le.prototype,"data",[mt.I,Se],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return this.data}}),Ue=(0,ut.Z)(Le.prototype,"suggestions",[mt.I,xe],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return this.suggestions}}),Le),oi=i(45715),ri=(Be=Reflect.metadata("design:type",yt.e),Me=function(t){(0,l.Z)(i,t);var e=(0,u.Z)(i);function i(){var t,a;(0,r.Z)(this,i);for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return(a=e.call.apply(e,d()(t=[this]).call(t,s))).badSurpanakhaSequence=0,(0,nt.Z)(a,"actors",We,(0,ot.Z)(a)),a}return(0,st.Z)(i,[{key:"initialise",value:function(){(0,rt.Z)((0,lt.Z)(i.prototype),"initialise",this).call(this),this.addEventHook((0,gt.hX)().type("complete"),this.onCompleteExtra)}},{key:"getMaxWeaves",value:function(t){var e=this,a=0,n=!1,s=t.weaves;if(s.forEach((function(t){t.action===e.data.actions.SURPANAKHA.id?a++:a>=1&&a<4&&(n=!0)})),(n||a&&4!==a)&&this.badSurpanakhaSequence++,a&&!n&&s.length>a&&s.length<=6&&s[s.length-1].action===this.data.actions.SURPANAKHA.id&&this.actors.current.hasStatus(this.data.statuses.WAXING_NOCTURNE.id)){var o=1e3*(s.length+1);if(t.gcdTimeDiff<o)return s.length}return a&&s.length===a&&t.gcdTimeDiff<1e3*(a+1)?a:(0,rt.Z)((0,lt.Z)(i.prototype),"getMaxWeaves",this).call(this,t)}},{key:"onCompleteExtra",value:function(){var t;this.suggestions.add(new bt.eg({icon:this.data.actions.SURPANAKHA.icon,content:(0,It.jsx)(pt.Trans,{id:"blu.weaving.bad_surpanakha.content",defaults:"Use all four <0/> charges at the same time, with no other actions in-between.  Even <1/> or using an item will cancel the buff.",components:[(0,It.jsx)(vt.P9,{action:"SURPANAKHA"}),(0,It.jsx)(vt.P9,{action:"SPRINT",showIcon:!1})]}),why:(0,It.jsx)(pt.Trans,{id:"blu.weaving.bad_surpanakha.why",defaults:"{0, plural, one {# Surpanakha chain} other {# Surpanakha chains}} dropped the buff early.",values:{0:null!==(t=this.badSurpanakhaSequence)&&void 0!==t?t:0}}),tiers:{1:bt.bI.MAJOR},value:this.badSurpanakhaSequence}))}}]),i}(oi.x),We=(0,ut.Z)(Me.prototype,"actors",[mt.I,Be],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return this.actors}}),Me),li=function(t){(0,l.Z)(i,t);var e=(0,u.Z)(i);function i(){return(0,r.Z)(this,i),e.apply(this,arguments)}return i}(i(74136).z);li.statusesStackMapping=(ze={},(0,ie.Z)(ze,se.ZP.BAD_BREATH_POISON.id,se.ZP.MALODOROUS.id),(0,ie.Z)(ze,se.ZP.WANING_NOCTURNE.id,se.ZP.WAXING_NOCTURNE.id),ze);var ui=[Jt,f,qt,ri,Tt,ee,s.J,ue,n.e,ni,le,qe,Yt,ai,Kt,ti,li,si,re]},44373:function(t,e,i){i(94944),i(1107);var a=i(35703);t.exports=a("Array").flat},68098:function(t,e,i){var a=i(44373),n=Array.prototype;t.exports=function(t){var e=t.flat;return t===n||t instanceof Array&&e===n.flat?a:e}},94944:function(t,e,i){"use strict";var a=i(76887),n=i(13092),s=i(89678),o=i(43057),r=i(68459),l=i(64692);a({target:"Array",proto:!0},{flat:function(){var t=arguments.length?arguments[0]:void 0,e=s(this),i=o(e.length),a=l(e,0);return a.length=n(a,e,e,i,0,void 0===t?1:r(t)),a}})},1107:function(t,e,i){i(18479)("flat")},34913:function(t,e,i){var a=i(68098);t.exports=a}}]);
//# sourceMappingURL=jobs-blu.aa6f174f.js.map