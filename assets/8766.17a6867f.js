"use strict";(self.webpackChunk_xivanalysis_client=self.webpackChunk_xivanalysis_client||[]).push([[8766],{83134:function(t,e,i){i.d(e,{G:function(){return r}});var n=i(68420),a=i(27344),r=function(){function t(e){(0,n.Z)(this,t),this._parser=void 0,this._resourceGraphs=void 0,this._parser=e.parser}return(0,a.Z)(t,[{key:"parser",get:function(){if(!this._parser)throw new Error("No parser found. Ensure this gauge is being passed to the core gauge module, or initialised with a reference to the parser.");return this._parser}},{key:"resourceGraphs",get:function(){if(!this._resourceGraphs)throw new Error("No resource graphs found. Ensure this gauge is being passed to the core gauge module, or initialised with a reference to the resource graphs.");return this._resourceGraphs}},{key:"setParser",value:function(t){this._parser=t}},{key:"setResourceGraphs",value:function(t){this._resourceGraphs=t}},{key:"generateResourceGraph",value:function(){}},{key:"generateDataset",value:function(){}}]),t}()},40103:function(t,e,i){i.d(e,{a:function(){return P}});var n,a,r,s,o,u,h,m=i(23257),l=i(68420),c=i(27344),p=i(5281),d=i(90306),v=i(50596),f=i(300),g=i(77766),y=i.n(g),k=i(20116),x=i.n(k),E=i(2991),T=i.n(E),G=i(82492),_=i.n(G),Z=i(67294),H=i(46799),b=i(85893),w={aspectRatio:3,scales:{xAxes:[{type:"time",time:{displayFormats:{minute:"m:ss",second:"m:ss",millisecond:"m:ss.SS"},tooltipFormat:"mm:ss.SSS"}}]}},M=function(t){(0,d.Z)(i,t);var e=(0,v.Z)(i);function i(){return(0,l.Z)(this,i),e.apply(this,arguments)}return(0,c.Z)(i,[{key:"render",value:function(){var t=_()({},w,this.props.options||{});return(0,b.jsx)(H.x1,{data:this.props.data,options:t,width:t.aspectRatio,height:1})}}]),i}(Z.PureComponent),R=i(28683),S=i(74489),O=i(76704),C=i(40753),A=i(73947),D=i(36356),K=i(36769),N=["TEMPORAL_DISPLACEMENT_INTERMISSION","TEMPORAL_DISPLACEMENT_ENRAGE"],P=(n=Reflect.metadata("design:type",D.$),a=Reflect.metadata("design:type",A.V),h=u=function(t){(0,d.Z)(i,t);var e=(0,v.Z)(i);function i(){var t,n;(0,l.Z)(this,i);for(var a=arguments.length,r=new Array(a),u=0;u<a;u++)r[u]=arguments[u];return n=e.call.apply(e,y()(t=[this]).call(t,r)),(0,m.Z)(n,"resourceGraphs",s,(0,p.Z)(n)),(0,m.Z)(n,"data",o,(0,p.Z)(n)),n.gauges=[],n}return(0,c.Z)(i,[{key:"initialise",value:function(){var t=this;this.addEventHook({type:"death",actor:this.parser.actor.id},this.onDeath),this.addEventHook({type:"raise",actor:this.parser.actor.id},this.onRaise);var e=(0,S.hX)().target(this.parser.actor.id).status(this.data.matchStatusId(N));this.addEventHook(e.type("statusApply"),this.onPauseTimers),this.addEventHook(e.type("statusRemove"),this.onResumeTimers),this.addEventHook("complete",(function(){return t.gauges.forEach((function(t){return t.generateResourceGraph()}))}))}},{key:"add",value:function(t){return t.setParser(this.parser),t instanceof K.v&&(t.setAddTimestampHook(this.addTimestampHook.bind(this)),t.setRemoveTimestampHook(this.removeTimestampHook.bind(this))),t.setResourceGraphs(this.resourceGraphs),t.init(),this.gauges.push(t),t}},{key:"onDeath",value:function(t){this.gauges.forEach((function(t){return t.reset()}))}},{key:"onRaise",value:function(){this.gauges.forEach((function(t){return t.raise()}))}},{key:"onPauseTimers",value:function(){this.gauges.forEach((function(t){t instanceof K.v&&(t.paused||t.pause())}))}},{key:"onResumeTimers",value:function(){this.gauges.forEach((function(t){t instanceof K.v&&t.resume()}))}},{key:"output",value:function(){var t,e,i=x()(t=T()(e=this.gauges).call(e,(function(t){return t.generateDataset()}))).call(t,C.$K);if(i.length<1)return!1;var n={datasets:i};return(0,b.jsx)(M,{data:n})}}]),i}(R.qk),u.handle="gauge",u.title={id:"core.gauge.title",defaults:"Gauge"},r=h,s=(0,f.Z)(r.prototype,"resourceGraphs",[O.I,n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return this.resourceGraphs}}),o=(0,f.Z)(r.prototype,"data",[O.I,a],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return this.data}}),r)},36769:function(t,e,i){i.d(e,{v:function(){return f}});var n=i(97530),a=i(68420),r=i(27344),s=i(90306),o=i(50596),u=i(2991),h=i.n(u),m=i(20116),l=i.n(m),c=i(32366),p=i.n(c),d=i(60402);function v(t){if(!t)throw new Error("Missing something required. Check the stack trace.");return t}var f=function(t){(0,s.Z)(i,t);var e=(0,o.Z)(i);function i(t){var n;return(0,a.Z)(this,i),(n=e.call(this,t)).minimum=0,n.maximum=void 0,n.expirationCallback=void 0,n.graphOptions=void 0,n.hook=void 0,n.history=[],n._addTimestampHook=void 0,n._removeTimestampHook=void 0,n.onExpiration=function(t){n.expirationCallback&&n.expirationCallback(t),n.history.push({timestamp:n.parser.currentEpochTimestamp,remaining:n.remaining,paused:!1})},n.maximum=t.maximum,n.expirationCallback=t.onExpiration,n.graphOptions=t.graph,n}return(0,r.Z)(i,[{key:"addTimestampHook",get:function(){return v(this._addTimestampHook)}},{key:"removeTimestampHook",get:function(){return v(this._removeTimestampHook)}},{key:"lastKnownState",get:function(){var t=this.history.length;if(0!==t)return this.history[t-1]}},{key:"remaining",get:function(){if(!this.lastKnownState)return this.minimum;if(this.lastKnownState.paused)return this.lastKnownState.remaining;var t=this.parser.currentEpochTimestamp-this.lastKnownState.timestamp;return Math.max(this.minimum,this.lastKnownState.remaining-t)}},{key:"expired",get:function(){return this.remaining<=this.minimum}},{key:"paused",get:function(){return!!this.lastKnownState&&this.lastKnownState.paused}},{key:"active",get:function(){return!(this.expired||this.paused)}},{key:"reset",value:function(){this.set(this.minimum)}},{key:"start",value:function(){this.set(this.maximum)}},{key:"refresh",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.expired&&t||this.start()}},{key:"extend",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.expired&&e||this.set(this.remaining+t)}},{key:"pause",value:function(){this.set(this.remaining,!0)}},{key:"resume",value:function(){this.set(this.remaining,!1)}},{key:"set",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=this.parser.currentEpochTimestamp;this.history.push({timestamp:i,remaining:this.remaining,paused:this.paused});var n=Math.max(this.minimum,Math.min(t,this.maximum));this.history.push({timestamp:i,remaining:n,paused:e}),this.hook&&this.removeTimestampHook(this.hook),!e&&n>0&&(this.hook=this.addTimestampHook(i+n,this.onExpiration))}},{key:"raise",value:function(){}},{key:"init",value:function(){0===this.history.length&&this.reset()}},{key:"generateResourceGraph",value:function(){var t,e=this;if(this.graphOptions){this.pause();var i=this.graphOptions,a=i.handle,r={label:i.label,colour:i.color,data:h()(t=this.history).call(t,(function(t){return{time:t.timestamp,current:t.remaining/1e3,maximum:e.maximum/1e3}})),linear:!0};null!=a?(this.resourceGraphs.addDataGroup((0,n.Z)((0,n.Z)({},this.graphOptions),{},{handle:a})),this.resourceGraphs.addData(a,r)):this.resourceGraphs.addGauge(r,(0,n.Z)((0,n.Z)({},this.graphOptions),{},{handle:d.p1}))}}},{key:"setAddTimestampHook",value:function(t){this._addTimestampHook=t}},{key:"setRemoveTimestampHook",value:function(t){this._removeTimestampHook=t}},{key:"internalExpirationTime",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.parser.pull.timestamp,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.parser.currentEpochTimestamp,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=void 0,s=[];if(this.history.forEach((function(e){e.remaining<=t.minimum&&null==r&&(r=e.timestamp),e.remaining>t.minimum&&null!=r&&(e.timestamp>r&&s.push({start:r,end:e.timestamp}),r=void 0)})),0===s.length)return[];var o=[];return s.forEach((function(t){(t.end>e||t.start<i)&&(n.length>0&&l()(n).call(n,(function(e){return t.start>=e.start&&t.start<=e.end})).forEach((function(e){return t.start=Math.min(t.end,e.end+a)})),t.start<t.end&&o.push(t))})),o}},{key:"isExpired",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.parser.currentEpochTimestamp;return this.internalExpirationTime(t,t).length>0}},{key:"getExpirationTime",value:function(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.parser.pull.timestamp,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.parser.currentEpochTimestamp,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return p()(t=this.internalExpirationTime(e,i,n,a)).call(t,(function(t,n){return t+Math.min(n.end,i)-Math.max(n.start,e)}),0)}},{key:"getExpirationWindows",value:function(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.parser.pull.timestamp,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.parser.currentEpochTimestamp,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return p()(t=this.internalExpirationTime(e,i,n,a)).call(t,(function(t,n){return t.push({start:Math.max(n.start,e),end:Math.min(n.end,i)}),t}),[])}}]),i}(i(83134).G)},78766:function(t,e,i){i.d(e,{qT:function(){return _},aC:function(){return n.a},vf:function(){return Z.v}});var n=i(40103),a=i(97530),r=i(68420),s=i(27344),o=i(90306),u=i(50596),h=i(7436),m=i.n(h),l=i(30988),c=i.n(l),p=i(32366),d=i.n(p),v=i(20116),f=i.n(v),g=i(3649),y=i.n(g),k=i(2991),x=i.n(k),E=i(6767),T=i.n(E),G=i(60402),_=function(t){(0,o.Z)(i,t);var e=(0,u.Z)(i);function i(){var t,n,a,s,o,u,h=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,r.Z)(this,i),(u=e.call(this,h)).initialValue=void 0,u._value=void 0,u.minimum=void 0,u.maximum=void 0,u.overCap=0,u.correctHistory=void 0,u.deterministic=void 0,u.chartOptions=void 0,u.graphOptions=void 0,u.history=[],u.generate=function(t){return u.modify(t)},u.spend=function(t){return u.modify(-t)},u.minimum=null!==(t=h.minimum)&&void 0!==t?t:0,u.initialValue=null!==(n=h.initialValue)&&void 0!==n?n:u.minimum,u._value=u.initialValue,u.maximum=null!==(a=h.maximum)&&void 0!==a?a:100,u.correctHistory=null!==(s=h.correctHistory)&&void 0!==s&&s,u.deterministic=null===(o=h.deterministic)||void 0===o||o,u.chartOptions=h.chart,u.graphOptions=h.graph,u}return(0,s.Z)(i,[{key:"value",get:function(){return this._value}},{key:"capped",get:function(){return this._value>=this.maximum}},{key:"empty",get:function(){return this._value<=this.minimum}},{key:"totalSpent",get:function(){var t,e;return d()(t=f()(e=this.history).call(e,(function(t){return"spend"===t.reason}))).call(t,(function(t,e){return t+Math.abs(e.delta)}),0)}},{key:"totalGenerated",get:function(){var t,e;return d()(t=f()(e=this.history).call(e,(function(t){return"generate"===t.reason}))).call(t,(function(t,e){return t+Math.abs(e.delta)}),0)}},{key:"getValueAt",value:function(t){var e=c()(this.history,(function(e){return e.timestamp<=t}));return e?e.value:this.minimum}},{key:"reset",value:function(){this.set(this.minimum,"reset")}},{key:"raise",value:function(){this.set(this.minimum,"init")}},{key:"init",value:function(){0===this.history.length&&this.history.push({timestamp:this.parser.pull.timestamp,value:this.initialValue,minimum:this.minimum,maximum:this.maximum,delta:0,reason:"init"})}},{key:"modify",value:function(t){this.set(this._value+t)}},{key:"set",value:function(t,e){var i=t-this.value,n=(null!=e?e:i>0)?"generate":"spend",a=Math.min(Math.max(t,this.minimum),this.maximum),r=t-a;r>0?this.overCap+=r:r<0&&this.correctHistory&&this.correctGaugeHistory(i,this._value),this._value=a,this.pushHistory(n,i)}},{key:"correctGaugeHistory",value:function(t,e){var i,n=this;t=Math.abs(t);for(var a=m()(this.history,(function(t){return!n.deterministic&&"generate"===t.reason||"init"===t.reason})),r=Math.abs(e-t),s=a;s<this.history.length;s++)this.history[s].value+=r;if(0!==a)for(var o=m()(y()(i=this.history).call(i,0,a),(function(t){return"generate"!==t.reason})),u=r/(a-o),h=o+1;h<a;h++)this.history[h].value+=u*(h-o)}},{key:"setMinimum",value:function(t){this.setBounds(t,this.maximum)}},{key:"setMaximum",value:function(t){this.setBounds(this.minimum,t)}},{key:"setBounds",value:function(t,e){this.minimum=t,this.maximum=e,this.set(this._value,"changeBounds")}},{key:"pushHistory",value:function(t,e){var i=this.parser.currentEpochTimestamp;if(i===(this.history.length?this.history[this.history.length-1].timestamp:NaN)){var n=this.history.pop();"spend"!==(null==n?void 0:n.reason)&&"init"!==(null==n?void 0:n.reason)||(t=n.reason)}this.history.push({timestamp:i,value:this._value,minimum:this.minimum,maximum:this.maximum,delta:e,reason:t})}},{key:"generateResourceGraph",value:function(){var t;if(null!=this.graphOptions){var e=this.graphOptions,i=e.handle,n=e.color,r={label:e.label,colour:n,data:x()(t=this.history).call(t,(function(t){return{time:t.timestamp,current:t.value,maximum:t.maximum}}))};null!=i?(this.resourceGraphs.addDataGroup((0,a.Z)((0,a.Z)({},this.graphOptions),{},{handle:i})),this.resourceGraphs.addData(i,r)):this.resourceGraphs.addGauge(r,(0,a.Z)((0,a.Z)({},this.graphOptions),{},{handle:G.p1}))}}},{key:"generateDataset",value:function(){var t,e=this;if(null!=this.chartOptions&&null==this.graphOptions){var i=x()(t=this.history).call(t,(function(t){return{t:t.timestamp-e.parser.pull.timestamp,y:t.value}})),n=this.chartOptions,a=n.label,r=n.color,s={label:a,data:i,steppedLine:!0};if(r){var o=T()(r);s.backgroundColor=o.fade(.8).toString(),s.borderColor=o.fade(.5).toString()}return s}}}]),i}(i(83134).G),Z=i(36769)}}]);
//# sourceMappingURL=8766.17a6867f.js.map