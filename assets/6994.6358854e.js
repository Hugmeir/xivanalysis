"use strict";(self.webpackChunk_xivanalysis_client=self.webpackChunk_xivanalysis_client||[]).push([[6994],{54106:function(e,t,s){s.d(t,{C:function(){return P}});var a,n,i,r,o,l,c,u=s(97530),d=s(23257),h=s(68420),g=s(27344),f=s(5281),m=s(90306),p=s(50596),v=s(300),x=s(77766),y=s.n(x),w=s(39392),Z=s.n(w),b=s(2991),j=s.n(b),A=s(94473),U=s.n(A),k=s(32366),T=s.n(k),C=s(66419),E=s.n(C),R=s(89400),D=s.n(R),I=s(20116),N=s.n(I),B=s(86359),M=s(9263),H=s(76704),z=s(52250),F=(s(67294),s(65927)),O=s(40753),S=s(28683),_=s(74489),L=s(73947),G=s(85893),P=(a=Reflect.metadata("design:type",z.ZP),n=Reflect.metadata("design:type",L.V),c=l=function(e){(0,m.Z)(s,e);var t=(0,p.Z)(s);function s(){var e,a;(0,h.Z)(this,s);for(var n=arguments.length,i=new Array(n),l=0;l<n;l++)i[l]=arguments[l];return a=t.call.apply(t,y()(e=[this]).call(e,i)),(0,d.Z)(a,"suggestions",r,(0,f.Z)(a)),(0,d.Z)(a,"data",o,(0,f.Z)(a)),a.suggestionIcon=void 0,a.trackedActions=void 0,a.severity={1:z.bI.MINOR,4:z.bI.MEDIUM,7:z.bI.MAJOR},a.suggestionContent=(0,G.jsx)(B.Trans,{id:"core.aoeusages.suggestion.content",defaults:"Avoid using AoE actions when they would do less damage than an alternative single-target action that shares a resource cost or cooldown. If the AoE skill cannot hit enough targets, the single-target action will do more total damage and should be used instead."}),a.badUsages=new(Z()),a}return(0,g.Z)(s,[{key:"initialise",value:function(){var e,t=(0,_.hX)().type("action").action((0,_.kw)(j()(e=this.trackedActions).call(e,(function(e){return e.aoeAction.id}))));this.addEventHook((0,_.hX)().source(this.parser.actor.id).type("damage").cause(t),this.onAbility),this.addEventHook("complete",this.onComplete)}},{key:"adjustMinTargets",value:function(e,t){return t}},{key:"onAbility",value:function(e){var t;if("action"===e.cause.type){var s=e.cause.action,a=U()(t=this.trackedActions).call(t,(function(t){return"action"===e.cause.type&&t.aoeAction.id===s}));if(void 0!==a){var n=this.adjustMinTargets(e,a.minTargets);(0,O.SV)(e)&&e.targets.length<n&&this.badUsages.set(s,(this.badUsages.get(s)||0)+1)}}}},{key:"onComplete",value:function(){var e,t,s=T()(e=E()(D()(t=this.badUsages).call(t))).call(e,(function(e,t){return e+t}),0);this.suggestions.add(new z.eg({icon:this.suggestionIcon,content:this.suggestionContent,tiers:this.severity,value:s,why:(0,G.jsx)(B.Trans,{id:"core.aoeusages.suggestion.why",defaults:"AoE actions were used against too few targets {totalBadUsages, plural, one {# time} other {# times}}.",values:{totalBadUsages:s}})}))}},{key:"output",value:function(){var e,t,s=this;if(0!==this.badUsages.size)return(0,G.jsx)(G.Fragment,{children:(0,G.jsxs)(F.Z,{collapsing:!0,unstackable:!0,children:[(0,G.jsx)(F.Z.Header,{children:(0,G.jsxs)(F.Z.Row,{children:[(0,G.jsx)(F.Z.HeaderCell,{children:(0,G.jsx)(B.Trans,{id:"core.aoeusages.aoe-ability",defaults:"AoE Action Used"})}),(0,G.jsx)(F.Z.HeaderCell,{children:(0,G.jsx)(B.Trans,{id:"core.aoeusages.st-alternative",defaults:"Single Target Alternative"})}),(0,G.jsx)(F.Z.HeaderCell,{children:(0,G.jsx)(B.Trans,{id:"core.aoeusages.min-targets",defaults:"Minimum Targets"})}),(0,G.jsx)(F.Z.HeaderCell,{children:(0,G.jsx)(B.Trans,{id:"core.aoeusages.number-bad-usages",defaults:"Incorrect Usages"})})]})}),(0,G.jsx)(F.Z.Body,{children:j()(e=N()(t=this.trackedActions).call(t,(function(e){return s.badUsages.has(e.aoeAction.id)}))).call(e,(function(e){var t;return(0,G.jsxs)(F.Z.Row,{children:[(0,G.jsx)(F.Z.Cell,{children:(0,G.jsx)(M.vm,(0,u.Z)({},e.aoeAction))}),(0,G.jsx)(F.Z.Cell,{children:j()(t=e.stActions).call(t,(function(e){return(0,G.jsxs)(G.Fragment,{children:[(0,G.jsx)(M.vm,(0,u.Z)({},e))," "]})}))}),(0,G.jsx)(F.Z.Cell,{children:e.minTargets}),(0,G.jsx)(F.Z.Cell,{children:s.badUsages.get(e.aoeAction.id)})]},e.aoeAction.id)}))})]})})}}]),s}(S.qk),l.handle="aoeusages",l.title={id:"core.aoeusages.title",defaults:"Incorrect AoE Action Usage"},i=c,r=(0,v.Z)(i.prototype,"suggestions",[H.I,a],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return this.suggestions}}),o=(0,v.Z)(i.prototype,"data",[H.I,n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return this.data}}),i)},12541:function(e,t,s){s.d(t,{O:function(){return Q}});var a,n,i,r,o,l,c,u,d,h,g,f=s(97530),m=s(23257),p=s(68420),v=s(27344),x=s(5281),y=s(90306),w=s(50596),Z=s(300),b=s(39392),j=s.n(b),A=s(77766),U=s.n(A),k=s(2991),T=s.n(k),C=s(94473),E=s.n(C),R=s(20116),D=s.n(R),I=s(32366),N=s.n(I),B=s(86359),M=s(9263),H=s(43719),z=s(28683),F=s(76704),O=s(48945),S=s(73947),_=s(67294),L=s(68156),G=s(45150),P=s(30919),V=s(65927),W=s(80967),q=s(81336),X=s(8437),Y=s(56611),J=s(85893),K=new(j())([["TANK",["RAMPART","REPRISAL"]],["MELEE",["FEINT","BLOODBATH","SECOND_WIND"]],["PHYSICAL_RANGED",["SECOND_WIND"]],["MAGICAL_RANGED",["ADDLE"]],["HEALER",[]]]),Q=(a=Reflect.metadata("design:type",q.w),n=Reflect.metadata("design:type",O.u),i=Reflect.metadata("design:type",S.V),r=Reflect.metadata("design:type",Y.TY),g=h=function(e){(0,y.Z)(s,e);var t=(0,w.Z)(s);function s(){var e,a;(0,p.Z)(this,s);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return a=t.call.apply(t,U()(e=[this]).call(e,i)),(0,m.Z)(a,"cooldowns",l,(0,x.Z)(a)),(0,m.Z)(a,"cooldownDowntime",c,(0,x.Z)(a)),(0,m.Z)(a,"data",u,(0,x.Z)(a)),(0,m.Z)(a,"timeline",d,(0,x.Z)(a)),a.trackedDefensives=[],a.headerContent=(0,J.jsx)(B.Trans,{id:"core.defensives.header.content",defaults:"Using your mitigation and healing cooldowns can help you survive mistakes, or relieve some stress on the healers and let them deal more damage.<0/>While you shouldn't use them at the expense of your rotation or buff alignment, you should try to find helpful times to use them.",components:[(0,J.jsx)("br",{})]}),a}return(0,v.Z)(s,[{key:"initialise",value:function(){var e,t,s=this;(null!==(e=null===(t=K.get(H.W[this.parser.actor.job].role))||void 0===t?void 0:T()(t).call(t,(function(e){return s.data.actions[e]})))&&void 0!==e?e:[]).forEach((function(e){var t;E()(t=s.trackedDefensives).call(t,(function(t){return e.id===t.id}))||s.trackedDefensives.push(e)}))}},{key:"getUsageCount",value:function(e){return this.getUses(e).length}},{key:"getUses",value:function(e){var t;return D()(t=this.cooldowns.cooldownHistory(e)).call(t,(function(e){return e.endReason!==q.g.INTERRUPTED}))}},{key:"getMaxUses",value:function(e){var t,s=this,a=N()(t=this.getUses(e)).call(t,(function(t,a){return t+s.getAdditionalUsageData(e,a.start).chargesBeforeNextUse}),this.getAdditionalUsageData(e).chargesBeforeNextUse);return this.getUsageCount(e)+a}},{key:"output",value:function(){var e,t=this;if(0!==this.trackedDefensives.length)return(0,J.jsxs)(_.Fragment,{children:[(0,J.jsxs)(L.Z,{icon:!0,children:[(0,J.jsx)(G.Z,{name:"info"}),(0,J.jsxs)(L.Z.Content,{children:[this.headerContent,(0,J.jsx)("br",{}),(0,J.jsx)("br",{}),(0,J.jsx)(B.Trans,{id:"core.defensives.header.sub-content",defaults:"The below tables will show you where you can gain additional uses of these cooldowns, without interfering with your existing ones."})]})]}),(0,J.jsx)(P.Z,{exclusive:!1,styled:!0,fluid:!0,panels:T()(e=this.trackedDefensives).call(e,(function(e,s){var a;return{key:e.id,title:{content:(0,J.jsxs)(J.Fragment,{children:[(0,J.jsx)(M.vm,(0,f.Z)({},e),s)," - ",t.getUsageCount(e)," / ",t.getMaxUses(e)]})},content:{content:(0,J.jsx)(V.Z,{compact:!0,unstackable:!0,celled:!0,children:(0,J.jsxs)(V.Z.Body,{children:[t.tryGetAdditionalUseRow(e),T()(a=t.getUses(e)).call(a,(function(s){return t.getUsageRow(s,e)}))]})})}}}))})]})}},{key:"getUsageRow",value:function(e,t){var s=this;return(0,J.jsxs)(J.Fragment,{children:[(0,J.jsx)(V.Z.Row,{children:(0,J.jsx)(V.Z.Cell,{children:(0,J.jsx)(B.Trans,{id:"core.defensives.table.usage-row.text",defaults:"Used at <0></0> {0}",values:{0:this.parser.formatEpochTimestamp(e.start)},components:[(0,J.jsx)(W.Z,{circular:!0,compact:!0,size:"mini",icon:"time",onClick:function(){return s.timeline.show(e.start-s.parser.pull.timestamp,e.end-s.parser.pull.timestamp)}})]})})},e.start),this.tryGetAdditionalUseRow(t,e.start)]})}},{key:"getAdditionalUsageData",value:function(e){var t,s,a,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.parser.pull.timestamp;if(n===this.parser.pull.timestamp)s=this.parser.pull.timestamp,a=e.charges||1;else{var i,r=E()(i=this.cooldowns.chargeHistory(e)).call(i,(function(e){return e.timestamp>=n&&e.current>0}));s=(null==r?void 0:r.timestamp)||this.parser.pull.duration+this.parser.pull.timestamp,a=(null==r?void 0:r.current)||0}var o=e.cooldown||this.parser.pull.duration,l=E()(t=this.getUses(e)).call(t,(function(e){return e.start>n})),c=null!=l?l.start-o:this.parser.pull.timestamp+this.parser.pull.duration;return c<=s?{chargesBeforeNextUse:0,availableTimestamp:s,useByTimestamp:c}:{chargesBeforeNextUse:a+Math.floor((c-s)/o),availableTimestamp:s,useByTimestamp:c}}},{key:"tryGetAdditionalUseRow",value:function(e){var t=this,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.parser.pull.timestamp,a=this.getAdditionalUsageData(e,s),n=a.chargesBeforeNextUse,i=a.availableTimestamp,r=a.useByTimestamp;return 0===n?(0,J.jsx)(J.Fragment,{}):(0,J.jsx)(V.Z.Row,{children:(0,J.jsx)(V.Z.Cell,{children:(0,J.jsx)(B.Trans,{id:"core.defensives.table.extra-usage-row.text",defaults:"{chargesBeforeNextUse, plural, one {1 extra use} other {# extra uses}} available between <0></0> {0} and {1}",values:{0:this.parser.formatEpochTimestamp(i),1:this.parser.formatEpochTimestamp(r),chargesBeforeNextUse:n},components:[(0,J.jsx)(W.Z,{circular:!0,compact:!0,size:"mini",icon:"time",onClick:function(){return t.timeline.show(i-t.parser.pull.timestamp,r-t.parser.pull.timestamp)}})]})})})}}]),s}(z.qk),h.handle="defensives",h.title={id:"core.defensives.title",defaults:"Defensives"},h.displayOrder=X.Z.DEFENSIVES,o=g,l=(0,Z.Z)(o.prototype,"cooldowns",[F.I,a],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return this.cooldowns}}),c=(0,Z.Z)(o.prototype,"cooldownDowntime",[F.I,n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return this.cooldownDowntime}}),u=(0,Z.Z)(o.prototype,"data",[F.I,i],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return this.data}}),d=(0,Z.Z)(o.prototype,"timeline",[F.I,r],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return this.timeline}}),o)}}]);
//# sourceMappingURL=6994.6358854e.js.map